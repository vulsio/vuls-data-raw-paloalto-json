{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2020-2035",
		"assignerOrgId": "00000000-0000-4000-9000-000000000000",
		"assignerShortName": "palo_alto",
		"serial": 1,
		"state": "PUBLISHED",
		"datePublished": "2020-08-12T07:00:00.000Z",
		"dateUpdated": "2021-07-20T00:00:00.000Z",
		"dateReserved": "2020-08-12T07:00:00.000Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "00000000-0000-4000-9000-000000000000",
				"shortName": "palo_alto",
				"dateUpdated": "2021-06-10T19:33:00.000Z"
			},
			"title": "PAN-OS: URL filtering policy is not enforced on TLS handshakes for decrypted HTTPS sessions",
			"descriptions": [
				{
					"lang": "en",
					"value": "When SSL/TLS Forward Proxy Decryption mode has been configured to decrypt the web transactions, the PAN-OS URL filtering feature inspects the HTTP Host and URL path headers for policy enforcement on the decrypted HTTPS web transactions but does not consider Server Name Indication (SNI) field within the TLS Client Hello handshake.\n\nThis allows a compromised host in a protected network to evade any security policy that uses URL filtering on a firewall configured with SSL Decryption in the Forward Proxy mode. A malicious actor can then use this technique to evade detection of communication on the TLS handshake phase between a compromised host and a remote malicious server.\n\nThis technique does not increase the risk of a host being compromised in the network. It does not impact the confidentiality or availability of a firewall. This is considered to have a low impact on the integrity of the firewall because the firewall fails to enforce a policy on certain traffic that should have been blocked.\n\nThis issue does not impact the URL filtering policy enforcement on clear text or encrypted web transactions.\n\nThis technique can be used only after a malicious actor has compromised a host in the protected network and the TLS/SSL Decryption feature is enabled for the traffic that the attacker controls.\n\nPalo Alto Networks is not aware of any malware that uses this technique to exfiltrate data.\n\nThis issue is applicable to all current versions of PAN-OS.\n\nThis issue does not impact Panorama or WF-500 appliances.\n\nThis issue does not impact PAN-OS appliances running PAN-OS 10.1 (and later versions of PAN-OS) when CTD inspection is enabled in the appliance configuration.",
					"supportingMedia": [
						{
							"base64": true,
							"type": "text/html",
							"value": "<pre>When SSL/TLS Forward Proxy Decryption mode has been configured to decrypt the web transactions, the PAN-OS URL filtering feature inspects the HTTP Host and URL path headers for policy enforcement on the decrypted HTTPS web transactions but does not consider Server Name Indication (SNI) field within the TLS Client Hello handshake.\n\nThis allows a compromised host in a protected network to evade any security policy that uses URL filtering on a firewall configured with SSL Decryption in the Forward Proxy mode. A malicious actor can then use this technique to evade detection of communication on the TLS handshake phase between a compromised host and a remote malicious server.\n\nThis technique does not increase the risk of a host being compromised in the network. It does not impact the confidentiality or availability of a firewall. This is considered to have a low impact on the integrity of the firewall because the firewall fails to enforce a policy on certain traffic that should have been blocked.\n\nThis issue does not impact the URL filtering policy enforcement on clear text or encrypted web transactions.\n\nThis technique can be used only after a malicious actor has compromised a host in the protected network and the TLS/SSL Decryption feature is enabled for the traffic that the attacker controls.\n\nPalo Alto Networks is not aware of any malware that uses this technique to exfiltrate data.\n\nThis issue is applicable to all current versions of PAN-OS.\n\nThis issue does not impact Panorama or WF-500 appliances.\n\nThis issue does not impact PAN-OS appliances running PAN-OS 10.1 (and later versions of PAN-OS) when CTD inspection is enabled in the appliance configuration.</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "PAN-OS",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.1.0"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.0.0"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "9.1.0"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "9.0.0"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "8.1.0"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-20 Improper Input Validation",
							"cweId": "CWE-20"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": ""
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:L/A:N",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"privilegesRequired": "HIGH",
						"userInteraction": "NONE",
						"scope": "CHANGED",
						"confidentialityImpact": "NONE",
						"integrityImpact": "LOW",
						"availabilityImpact": "NONE",
						"baseScore": 3,
						"baseSeverity": "LOW"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Customers concerned about the risk described in this advisory are encouraged to review the KB article https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008V4J for more information on background and mitigation options. To enforce URL filtering policy on TLS handshakes for decrypted HTTPS sessions, we suggest you use any one of the following workarounds:\n\n1. Route outbound traffic between two virtual systems (vsys) on PAN-OS firewalls that have vsys capability and perform URL Filtering on one vsys and perform SSL/TLS Decryption on the other vsys.\n\n2. Add two additional Security Zones and route outbound traffic between the two zones so that you can apply both \"Decrypt\" and \"No Decrypt\" Decryption policy rules. For example, configure your next-generation firewall so that traffic travels from the Inside zone to the Internal-DMZ zone where you applied a “No Decrypt” rule along with URL Filtering and then the traffic passes to the External-DMZ zone and from External-DMZ to the Internet zone where you applied a \"Decrypt\" rule. Be aware that this workaround configuration may significantly increase the load on your firewall.\n\n3. Use the additional security device in the traffic chain. \nThe SSL/TLS Decryption and URL Filtering functions should be separated (for example, the first device is performing URL Filtering and the second device is performing SSL/TLS Decryption).\n\nThese workarounds are described in detail at https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008V4J\n\nWe recommend you use an endpoint protection solution such as the Cortex XDR agent to significantly reduce the potential risk of hosts being compromised. See https://www.paloaltonetworks.com/cortex/endpoint-protection.\n\nCaution: We recommend that you do not disable SSL/TLS Decryption as a workaround to this issue. There are additional risks associated with this action. \n",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "Customers concerned about the risk described in this advisory are encouraged to review the KB article https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008V4J for more information on background and mitigation options. To enforce URL filtering policy on TLS handshakes for decrypted HTTPS sessions, we suggest you use any one of the following workarounds:\n\n1. Route outbound traffic between two virtual systems (vsys) on PAN-OS firewalls that have vsys capability and perform URL Filtering on one vsys and perform SSL/TLS Decryption on the other vsys.\n\n2. Add two additional Security Zones and route outbound traffic between the two zones so that you can apply both \"Decrypt\" and \"No Decrypt\" Decryption policy rules. For example, configure your next-generation firewall so that traffic travels from the Inside zone to the Internal-DMZ zone where you applied a “No Decrypt” rule along with URL Filtering and then the traffic passes to the External-DMZ zone and from External-DMZ to the Internet zone where you applied a \"Decrypt\" rule. Be aware that this workaround configuration may significantly increase the load on your firewall.\n\n3. Use the additional security device in the traffic chain. \nThe SSL/TLS Decryption and URL Filtering functions should be separated (for example, the first device is performing URL Filtering and the second device is performing SSL/TLS Decryption).\n\nThese workarounds are described in detail at https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u0000008V4J\n\nWe recommend you use an endpoint protection solution such as the Cortex XDR agent to significantly reduce the potential risk of hosts being compromised. See https://www.paloaltonetworks.com/cortex/endpoint-protection.\n\nCaution: We recommend that you do not disable SSL/TLS Decryption as a workaround to this issue. There are additional risks associated with this action. \n"
						}
					]
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is currently working to improve our inspection engines by adding a URL filtering policy check on both the TLS SNI field and the HTTP Host and URL headers for decrypted HTTPS transactions.\n\nIf your appliance is using PAN-OS 10.1 (or a later version of PAN-OS), enabling CTD inspection removes the security impact of this issue.\n\nYou can enable CTD inspection from the CLI with the following command:\nset deviceconfig setting ssl-decrypt scan-handshake yes\n\nYou can enable CTD inspection from the web management interface through the following menu:\nDevice > Setup > Session > Decryption Settings > SSL Decryption Settings > Send handshake messages to CTD for inspection\n\nIf using other impacted PAN-OS appliances, or unable to enable CTD inspection in appliances using PAN-OS 10.1 (or later versions of PAN-OS), apply any of the workarounds to completely mitigate the risk of evasion.\n\nThere are currently no other PAN-OS updates available for this issue.\n\n",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "Palo Alto Networks is currently working to improve our inspection engines by adding a URL filtering policy check on both the TLS SNI field and the HTTP Host and URL headers for decrypted HTTPS transactions.\n\nIf your appliance is using PAN-OS 10.1 (or a later version of PAN-OS), enabling CTD inspection removes the security impact of this issue.\n\nYou can enable CTD inspection from the CLI with the following command:\nset deviceconfig setting ssl-decrypt scan-handshake yes\n\nYou can enable CTD inspection from the web management interface through the following menu:\nDevice > Setup > Session > Decryption Settings > SSL Decryption Settings > Send handshake messages to CTD for inspection\n\nIf using other impacted PAN-OS appliances, or unable to enable CTD inspection in appliances using PAN-OS 10.1 (or later versions of PAN-OS), apply any of the workarounds to completely mitigate the risk of evasion.\n\nThere are currently no other PAN-OS updates available for this issue.\n\n"
						}
					]
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malware that uses this technique to exfiltrate data.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "Palo Alto Networks is not aware of any malware that uses this technique to exfiltrate data."
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "This URL filtering policy evasion situation is only applicable when the following conditions are true:\n\n1. A host in the network is already compromised by a malicious actor.\n\n2. The PAN-OS configuration must have the SSL/TLS Decryption Forward Proxy feature enabled for the specific traffic that the attacker controls.\n\n3. There is no other security device in the chain that performs URL Filtering or can block access to malicious URLs or IP-addresses on the encrypted SSL/TLS traffic.\n\nPAN-OS appliances running PAN-OS 10.1 (and later versions of PAN-OS) with CTD inspection enabled are not impacted by this vulnerability.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "This URL filtering policy evasion situation is only applicable when the following conditions are true:\n\n1. A host in the network is already compromised by a malicious actor.\n\n2. The PAN-OS configuration must have the SSL/TLS Decryption Forward Proxy feature enabled for the specific traffic that the attacker controls.\n\n3. There is no other security device in the chain that performs URL Filtering or can block access to malicious URLs or IP-addresses on the encrypted SSL/TLS traffic.\n\nPAN-OS appliances running PAN-OS 10.1 (and later versions of PAN-OS) with CTD inspection enabled are not impacted by this vulnerability."
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2020-2035"
				},
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://www.mnemonic.no/blog/introducing-snicat/"
				}
			],
			"timeline": [
				{
					"time": "2020-08-12T16:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				},
				{
					"time": "2021-03-03T17:00:00.000Z",
					"lang": "eng",
					"value": "Added clarification that Panorama and WF-500 appliances are not impacted"
				},
				{
					"time": "2021-06-09T16:00:00.000Z",
					"lang": "eng",
					"value": "Updated impacted versions to include PAN-OS 10.1"
				},
				{
					"time": "2021-07-20T16:00:00.000Z",
					"lang": "eng",
					"value": "Updated solution to include enabling CTD inspection for PAN-OS 10.1 appliances"
				}
			],
			"credits": [
				{
					"type": "finder",
					"lang": "en",
					"value": "Palo Alto Networks thanks Morten Marstrander and Matteo Malvica from mnemonic AS for discovering and reporting this issue."
				}
			],
			"source": {
				"defect": [
					"PAN-140086"
				],
				"discovery": "EXTERNAL"
			},
			"datePublic": "2020-08-12T16:00:00.000Z",
			"x_generator": {
				"engine": "vulnogram 0.1.0-rc1"
			},
			"x_affectedList": [
				"PAN-OS 10.1",
				"PAN-OS 10.0.11-h1",
				"PAN-OS 10.0.11",
				"PAN-OS 10.0.10",
				"PAN-OS 10.0.9",
				"PAN-OS 10.0.8-h8",
				"PAN-OS 10.0.8-h7",
				"PAN-OS 10.0.8-h6",
				"PAN-OS 10.0.8-h5",
				"PAN-OS 10.0.8-h4",
				"PAN-OS 10.0.8-h3",
				"PAN-OS 10.0.8-h2",
				"PAN-OS 10.0.8-h1",
				"PAN-OS 10.0.8",
				"PAN-OS 10.0.7",
				"PAN-OS 10.0.6",
				"PAN-OS 10.0.5",
				"PAN-OS 10.0.4",
				"PAN-OS 10.0.3",
				"PAN-OS 10.0.2",
				"PAN-OS 10.0.1",
				"PAN-OS 10.0.0",
				"PAN-OS 10.0",
				"PAN-OS 9.1.14-h4",
				"PAN-OS 9.1.14-h3",
				"PAN-OS 9.1.14-h2",
				"PAN-OS 9.1.14-h1",
				"PAN-OS 9.1.14",
				"PAN-OS 9.1.13-h3",
				"PAN-OS 9.1.13-h2",
				"PAN-OS 9.1.13-h1",
				"PAN-OS 9.1.13",
				"PAN-OS 9.1.12-h3",
				"PAN-OS 9.1.12-h2",
				"PAN-OS 9.1.12-h1",
				"PAN-OS 9.1.12",
				"PAN-OS 9.1.11-h3",
				"PAN-OS 9.1.11-h2",
				"PAN-OS 9.1.11-h1",
				"PAN-OS 9.1.11",
				"PAN-OS 9.1.10",
				"PAN-OS 9.1.9",
				"PAN-OS 9.1.8",
				"PAN-OS 9.1.7",
				"PAN-OS 9.1.6",
				"PAN-OS 9.1.5",
				"PAN-OS 9.1.4",
				"PAN-OS 9.1.3-h1",
				"PAN-OS 9.1.3",
				"PAN-OS 9.1.2-h1",
				"PAN-OS 9.1.2",
				"PAN-OS 9.1.1",
				"PAN-OS 9.1.0-h3",
				"PAN-OS 9.1.0-h2",
				"PAN-OS 9.1.0-h1",
				"PAN-OS 9.1.0",
				"PAN-OS 9.1",
				"PAN-OS 9.0.16-h3",
				"PAN-OS 9.0.16-h2",
				"PAN-OS 9.0.16-h1",
				"PAN-OS 9.0.16",
				"PAN-OS 9.0.15",
				"PAN-OS 9.0.14-h4",
				"PAN-OS 9.0.14-h3",
				"PAN-OS 9.0.14-h2",
				"PAN-OS 9.0.14-h1",
				"PAN-OS 9.0.14",
				"PAN-OS 9.0.13",
				"PAN-OS 9.0.12",
				"PAN-OS 9.0.11",
				"PAN-OS 9.0.10",
				"PAN-OS 9.0.9-h1",
				"PAN-OS 9.0.9",
				"PAN-OS 9.0.8",
				"PAN-OS 9.0.7",
				"PAN-OS 9.0.6",
				"PAN-OS 9.0.5",
				"PAN-OS 9.0.4",
				"PAN-OS 9.0.3-h3",
				"PAN-OS 9.0.3-h2",
				"PAN-OS 9.0.3-h1",
				"PAN-OS 9.0.3",
				"PAN-OS 9.0.2-h4",
				"PAN-OS 9.0.2-h3",
				"PAN-OS 9.0.2-h2",
				"PAN-OS 9.0.2-h1",
				"PAN-OS 9.0.2",
				"PAN-OS 9.0.1",
				"PAN-OS 9.0.0",
				"PAN-OS 9.0",
				"PAN-OS 8.1.23-h1",
				"PAN-OS 8.1.23",
				"PAN-OS 8.1.22",
				"PAN-OS 8.1.21-h1",
				"PAN-OS 8.1.21",
				"PAN-OS 8.1.20-h1",
				"PAN-OS 8.1.20",
				"PAN-OS 8.1.19",
				"PAN-OS 8.1.18",
				"PAN-OS 8.1.17",
				"PAN-OS 8.1.16",
				"PAN-OS 8.1.15-h3",
				"PAN-OS 8.1.15-h2",
				"PAN-OS 8.1.15-h1",
				"PAN-OS 8.1.15",
				"PAN-OS 8.1.14-h2",
				"PAN-OS 8.1.14-h1",
				"PAN-OS 8.1.14",
				"PAN-OS 8.1.13",
				"PAN-OS 8.1.12",
				"PAN-OS 8.1.11",
				"PAN-OS 8.1.10",
				"PAN-OS 8.1.9-h4",
				"PAN-OS 8.1.9-h3",
				"PAN-OS 8.1.9-h2",
				"PAN-OS 8.1.9-h1",
				"PAN-OS 8.1.9",
				"PAN-OS 8.1.8-h5",
				"PAN-OS 8.1.8-h4",
				"PAN-OS 8.1.8-h3",
				"PAN-OS 8.1.8-h2",
				"PAN-OS 8.1.8-h1",
				"PAN-OS 8.1.8",
				"PAN-OS 8.1.7",
				"PAN-OS 8.1.6-h2",
				"PAN-OS 8.1.6-h1",
				"PAN-OS 8.1.6",
				"PAN-OS 8.1.5",
				"PAN-OS 8.1.4",
				"PAN-OS 8.1.3",
				"PAN-OS 8.1.2",
				"PAN-OS 8.1.1",
				"PAN-OS 8.1.0",
				"PAN-OS 8.1"
			]
		}
	}
}
