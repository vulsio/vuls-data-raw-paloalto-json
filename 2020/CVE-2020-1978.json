{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2020-1978",
		"assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
		"assignerShortName": "palo_alto",
		"state": "PUBLISHED",
		"datePublished": "2020-02-19T00:00:00",
		"dateUpdated": "2020-02-19T00:00:00.000000Z",
		"dateReserved": "2020-02-19T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
				"shortName": "palo_alto",
				"dateUpdated": "2020-04-08T18:41:58"
			},
			"title": "VM-Series on Microsoft Azure: Inadvertent collection of credentials in Tech support files on HA configured VMs",
			"descriptions": [
				{
					"lang": "en",
					"value": "TechSupport files generated on Palo Alto Networks VM Series firewalls for Microsoft Azure platform configured with high availability (HA) inadvertently collect Azure dashboard service account credentials.\nThese credentials are equivalent to the credentials associated with the Contributor role in Azure.  A user with the credentials will be able to manage all the Azure resources in the subscription except for granting access to other resources. These credentials do not allow login access to the VMs themselves.\nThis issue affects VM Series Plugin versions before 1.0.9 for PAN-OS 9.0.\nThis issue does not affect VM Series in non-HA configurations or on other cloud platforms. It does not affect hardware firewall appliances.\nSince becoming aware of the issue, Palo Alto Networks has safely deleted all the tech support files with the credentials. We now filter and remove these credentials from all TechSupport files sent to us.\nThe TechSupport files uploaded to Palo Alto Networks systems were only accessible by authorized personnel with valid Palo Alto Networks credentials. We do not have any evidence of malicious access or use of these credentials.\n",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>TechSupport files generated on Palo Alto Networks VM Series firewalls for Microsoft Azure platform configured with high availability (HA) inadvertently collect Azure dashboard service account credentials.\nThese credentials are equivalent to the credentials associated with the Contributor role in Azure.  A user with the credentials will be able to manage all the Azure resources in the subscription except for granting access to other resources. These credentials do not allow login access to the VMs themselves.\nThis issue affects VM Series Plugin versions before 1.0.9 for PAN-OS 9.0.\nThis issue does not affect VM Series in non-HA configurations or on other cloud platforms. It does not affect hardware firewall appliances.\nSince becoming aware of the issue, Palo Alto Networks has safely deleted all the tech support files with the credentials. We now filter and remove these credentials from all TechSupport files sent to us.\nThe TechSupport files uploaded to Palo Alto Networks systems were only accessible by authorized personnel with valid Palo Alto Networks credentials. We do not have any evidence of malicious access or use of these credentials.\n</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "VM-Series Plugin",
					"platforms": [
						"Microsoft Azure"
					],
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "1.0",
							"lessThanOrEqual": "1.0.8",
							"changes": [
								{
									"at": "1.0.9",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-255 Credentials Management",
							"cweId": "CWE-255"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:H",
						"attackVector": "LOCAL",
						"attackComplexity": "LOW",
						"privilegesRequired": "HIGH",
						"userInteraction": "REQUIRED",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "NONE",
						"availabilityImpact": "HIGH",
						"baseScore": 5.8,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Do not generate TechSupport files on the affected VMs.\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Do not generate TechSupport files on the affected VMs.\n"
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "This issue is fixed in VM-Series Plugin 1.0.9 for Microsoft Azure.\nCustomers who generated TechSupport files on older versions are advised to change their Azure dashboard credentials. Customers are advised to delete any previously generated TechSupport files.\nInstructions to change the credentials:\n\n1. Create a new Service Principal with a Contributor role in the Azure AD Portal. Instructions to create a new Service Principal can be found here - https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal\n\n2. Update your Azure HA configuration in the PA-VM configuration with the new Service Principal credentials. The steps to update the configuration are provided in “Step 3” of the PA-VM Azure HA configuration guide - https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-on-azure/configure-activepassive-ha-for-vm-series-firewall-on-azure.html\n\n3. Delete the old Service Principal in the Azure AD Portal that was being used in the Azure HA configuration. Note: If the old Service Principal is used in other applications, then the other applications need to be updated with the new Service Principal.\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is fixed in VM-Series Plugin 1.0.9 for Microsoft Azure.\nCustomers who generated TechSupport files on older versions are advised to change their Azure dashboard credentials. Customers are advised to delete any previously generated TechSupport files.\nInstructions to change the credentials:\n\n1. Create a new Service Principal with a Contributor role in the Azure AD Portal. Instructions to create a new Service Principal can be found here - https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal\n\n2. Update your Azure HA configuration in the PA-VM configuration with the new Service Principal credentials. The steps to update the configuration are provided in “Step 3” of the PA-VM Azure HA configuration guide - https://docs.paloaltonetworks.com/vm-series/9-0/vm-series-deployment/set-up-the-vm-series-firewall-on-azure/configure-activepassive-ha-for-vm-series-firewall-on-azure.html\n\n3. Delete the old Service Principal in the Azure AD Portal that was being used in the Azure HA configuration. Note: If the old Service Principal is used in other applications, then the other applications need to be updated with the new Service Principal.\n"
					}
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "This issue only affects VM Series appliances with HA configuration on Microsoft Azure.\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue only affects VM Series appliances with HA configuration on Microsoft Azure.\n"
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2020-1978"
				}
			],
			"timeline": [
				{
					"time": "2020-02-19T17:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "This issue was found by Ranjeet Ramalingam during an internal security review."
				}
			],
			"source": {
				"defect": [
					"PLUG-3787"
				],
				"discovery": "INTERNAL"
			},
			"datePublic": "2020-04-08T16:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_affectedList": [
				"VM-Series Plugin 1.0"
			]
		}
	}
}
