{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2021-3034",
		"assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
		"assignerShortName": "palo_alto",
		"state": "PUBLISHED",
		"datePublished": "2021-03-10T00:00:00",
		"dateUpdated": "2021-03-15T00:00:00.000000Z",
		"dateReserved": "2021-03-10T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
				"shortName": "palo_alto",
				"dateUpdated": "2021-03-11T14:22:39"
			},
			"title": "Cortex XSOAR: Secrets for SAML single sign-on (SSO) integration may be logged in system logs",
			"descriptions": [
				{
					"lang": "en",
					"value": "An information exposure through log file vulnerability exists in Cortex XSOAR software where the secrets configured for the SAML single sign-on (SSO) integration can be logged to the '/var/log/demisto/' server logs when testing the integration during setup.\n\nThis logged information includes the private key and identity provider certificate used to configure the SAML SSO integration.",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>An information exposure through log file vulnerability exists in Cortex XSOAR software where the secrets configured for the SAML single sign-on (SSO) integration can be logged to the '/var/log/demisto/' server logs when testing the integration during setup.\n\nThis logged information includes the private key and identity provider certificate used to configure the SAML SSO integration.</pre>"
						}
					]
				},
				{
					"lang": "en",
					"value": "This issue impacts:\nCortex XSOAR 5.5.0 builds earlier than 98622;\nCortex XSOAR 6.0.1 builds earlier than 830029;\nCortex XSOAR 6.0.2 builds earlier than 98623;\nCortex XSOAR 6.1.0 builds earlier than 848144.\n",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>This issue impacts:\nCortex XSOAR 5.5.0 builds earlier than 98622;\nCortex XSOAR 6.0.1 builds earlier than 830029;\nCortex XSOAR 6.0.2 builds earlier than 98623;\nCortex XSOAR 6.1.0 builds earlier than 848144.\n</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "Cortex XSOAR",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "5.5.0",
							"lessThan": "98622",
							"changes": [
								{
									"at": "98622",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.0.2",
							"lessThan": "98623",
							"changes": [
								{
									"at": "98623",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.0.1",
							"lessThan": "830029"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0",
							"lessThan": "848144",
							"changes": [
								{
									"at": "848144",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-532 Information Exposure Through Log Files",
							"cweId": "CWE-532"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N",
						"attackVector": "LOCAL",
						"attackComplexity": "LOW",
						"privilegesRequired": "HIGH",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "LOW",
						"availabilityImpact": "NONE",
						"baseScore": 5.1,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "You must configure a new private key for SAML SSO integration and you should not run integration testing functions until after you complete the Cortex XSOAR upgrade.\n\nYou must clear all server system log files located in the '/var/log/demisto/' directory. There may be several files in this directory, including the server.log file and other archived server logs.\n\nYou can clear all server system logs by stopping the server and running the 'rm /var/log/demisto/server*.log' command from the console.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "You must configure a new private key for SAML SSO integration and you should not run integration testing functions until after you complete the Cortex XSOAR upgrade.\n\nYou must clear all server system log files located in the '/var/log/demisto/' directory. There may be several files in this directory, including the server.log file and other archived server logs.\n\nYou can clear all server system logs by stopping the server and running the 'rm /var/log/demisto/server*.log' command from the console."
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "This issue is fixed in Cortex XSOAR 5.5.0 build 98622, Cortex XSOAR 6.0.2 build 98623, Cortex XSOAR 6.1.0 build 848144, and all later Cortex XSOAR versions.\n\nAll versions of Cortex XSOAR 6.0.1 should be upgraded to the latest version of Cortex XSOAR 6.0.2.\n\nAfter you upgrade the Cortex XSOAR appliance, you must configure a new private key for SAML SSO integration. Clear the server system logs using the instructions provided in the Workarounds and Mitigations section to remove any potentially logged secrets.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is fixed in Cortex XSOAR 5.5.0 build 98622, Cortex XSOAR 6.0.2 build 98623, Cortex XSOAR 6.1.0 build 848144, and all later Cortex XSOAR versions.\n\nAll versions of Cortex XSOAR 6.0.1 should be upgraded to the latest version of Cortex XSOAR 6.0.2.\n\nAfter you upgrade the Cortex XSOAR appliance, you must configure a new private key for SAML SSO integration. Clear the server system logs using the instructions provided in the Workarounds and Mitigations section to remove any potentially logged secrets."
					}
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue.\n\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue.\n\n"
					}
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "This issue is applicable only to Cortex XSOAR appliances configured to use SAML SSO and where the 'Test' button or other integration testing functions, including testing automation, were used at some point.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is applicable only to Cortex XSOAR appliances configured to use SAML SSO and where the 'Test' button or other integration testing functions, including testing automation, were used at some point."
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2021-3034"
				}
			],
			"timeline": [
				{
					"time": "2021-03-10T17:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				},
				{
					"time": "2021-03-15T21:00:00.000Z",
					"lang": "eng",
					"value": "Updated required configuration for exposure and made upgrade notes for Cortex XSOAR 6.0.0.1"
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks thanks Martin Spielmann and Stefan Lubienetzki for discovering and reporting this issue."
				}
			],
			"source": {
				"defect": [
					"XSOAR-33287"
				],
				"discovery": "EXTERNAL"
			},
			"datePublic": "2021-03-10T17:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_affectedList": [
				"Cortex XSOAR 6.1.0",
				"Cortex XSOAR 6.0.2",
				"Cortex XSOAR 6.0.1",
				"Cortex XSOAR 5.5.0"
			]
		}
	}
}
