{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2021-3041",
		"assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
		"assignerShortName": "palo_alto",
		"state": "PUBLISHED",
		"datePublished": "2021-06-09T00:00:00",
		"dateUpdated": "2022-01-14T00:00:00.000000Z",
		"dateReserved": "2021-06-09T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
				"shortName": "palo_alto",
				"dateUpdated": "2021-06-10T12:33:06"
			},
			"title": "Cortex XDR Agent: Improper control of user-controlled file leads to local privilege escalation",
			"descriptions": [
				{
					"lang": "en",
					"value": "A local privilege escalation vulnerability exists in the Palo Alto Networks Cortex XDR agent on Windows platforms that enables an authenticated local Windows user to execute programs with SYSTEM privileges.\n\nThis requires the user to have the privilege to create files in the Windows root directory or to manipulate key registry values.",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>A local privilege escalation vulnerability exists in the Palo Alto Networks Cortex XDR agent on Windows platforms that enables an authenticated local Windows user to execute programs with SYSTEM privileges.\n\nThis requires the user to have the privilege to create files in the Windows root directory or to manipulate key registry values.</pre>"
						}
					]
				},
				{
					"lang": "en",
					"value": "This issue impacts:\nCortex XDR agent 5.0 versions earlier than Cortex XDR agent 5.0.11 on Windows;\nCortex XDR agent 6.1 versions earlier than Cortex XDR agent 6.1.8 on Windows;\nCortex XDR agent 7.2 versions earlier than Cortex XDR agent 7.2.3 on Windows;\nAll versions of Cortex XDR agent 7.2 without content update release 171 or a later version on Windows.\n",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>This issue impacts:\nCortex XDR agent 5.0 versions earlier than Cortex XDR agent 5.0.11 on Windows;\nCortex XDR agent 6.1 versions earlier than Cortex XDR agent 6.1.8 on Windows;\nCortex XDR agent 7.2 versions earlier than Cortex XDR agent 7.2.3 on Windows;\nAll versions of Cortex XDR agent 7.2 without content update release 171 or a later version on Windows.\n</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "Cortex XDR Agent",
					"platforms": [
						"Windows"
					],
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "5.0",
							"lessThan": "5.0.11",
							"changes": [
								{
									"at": "5.0.11",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1",
							"lessThan": "6.1.8",
							"changes": [
								{
									"at": "6.1.8",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "7.2",
							"lessThan": "7.2.3 or without content update 171 or later",
							"changes": [
								{
									"at": "7.2.3 with content update 171 or later",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-427 Uncontrolled Search Path Element",
							"cweId": "CWE-427"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"attackVector": "LOCAL",
						"attackComplexity": "LOW",
						"privilegesRequired": "LOW",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"availabilityImpact": "HIGH",
						"baseScore": 7.8,
						"baseSeverity": "HIGH"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "This issue is mitigated by preventing local authenticated Windows users from creating files in the Windows root directory (such as C:\\) and ensuring they are unable to manipulate the Windows registry.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is mitigated by preventing local authenticated Windows users from creating files in the Windows root directory (such as C:\\) and ensuring they are unable to manipulate the Windows registry."
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "This issue is fixed in Cortex XDR agent 5.0.11, Cortex XDR agent 6.1.8, Cortex XDR agent 7.2.3, and all later Cortex XDR agent versions.\n\nContent updates are required to resolve this issue and are automatically applied for the agent.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is fixed in Cortex XDR agent 5.0.11, Cortex XDR agent 6.1.8, Cortex XDR agent 7.2.3, and all later Cortex XDR agent versions.\n\nContent updates are required to resolve this issue and are automatically applied for the agent."
					}
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue.\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue.\n"
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2021-3041"
				}
			],
			"timeline": [
				{
					"time": "2021-06-09T16:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				},
				{
					"time": "2022-01-14T00:30:00.000Z",
					"lang": "eng",
					"value": "Update to affected platforms"
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "This issue was found by Robert McCallum of Palo Alto Networks during internal security review."
				}
			],
			"source": {
				"defect": [
					"CPATR-12634",
					"CPATR-12507",
					"CPATR-11927"
				],
				"discovery": "INTERNAL"
			},
			"datePublic": "2021-06-09T16:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_affectedList": [
				"Cortex XDR Agent 7.2",
				"Cortex XDR Agent 6.1",
				"Cortex XDR Agent 5.0"
			]
		}
	}
}
