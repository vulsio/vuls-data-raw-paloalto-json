{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2024-3400",
		"assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
		"assignerShortName": "palo_alto",
		"state": "PUBLISHED",
		"datePublished": "2024-04-12T00:00:00",
		"dateUpdated": "2024-05-03T00:00:00.000000Z",
		"dateReserved": "2024-04-12T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
				"shortName": "palo_alto",
				"dateUpdated": "2024-04-19T22:27:27.179Z"
			},
			"title": "PAN-OS: Arbitrary File Creation Leads to OS Command Injection Vulnerability in GlobalProtect",
			"descriptions": [
				{
					"lang": "en",
					"value": "A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.\n\nCloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.\n\nCustomers should continue to monitor this security advisory for the latest updates and product guidance.",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>A command injection as a result of arbitrary file creation vulnerability in the GlobalProtect feature of Palo Alto Networks PAN-OS software for specific PAN-OS versions and distinct feature configurations may enable an unauthenticated attacker to execute arbitrary code with root privileges on the firewall.\n\nCloud NGFW, Panorama appliances, and Prisma Access are not impacted by this vulnerability.\n\nCustomers should continue to monitor this security advisory for the latest updates and product guidance.</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "PAN-OS",
					"versions": [
						{
							"status": "unaffected",
							"version": "9.0 All"
						},
						{
							"status": "unaffected",
							"version": "9.1 All"
						},
						{
							"status": "unaffected",
							"version": "10.0 All"
						},
						{
							"status": "unaffected",
							"version": "10.1 All"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.2",
							"lessThan": "10.2.0-h3",
							"changes": [
								{
									"at": "10.2.0-h3",
									"status": "unaffected"
								},
								{
									"at": "10.2.1-h2",
									"status": "unaffected"
								},
								{
									"at": "10.2.2-h5",
									"status": "unaffected"
								},
								{
									"at": "10.2.3-h13",
									"status": "unaffected"
								},
								{
									"at": "10.2.4-h16",
									"status": "unaffected"
								},
								{
									"at": "10.2.5-h6",
									"status": "unaffected"
								},
								{
									"at": "10.2.6-h3",
									"status": "unaffected"
								},
								{
									"at": "10.2.7-h8",
									"status": "unaffected"
								},
								{
									"at": "10.2.8-h3",
									"status": "unaffected"
								},
								{
									"at": "10.2.9-h1",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "11.0",
							"lessThan": "11.0.0-h3",
							"changes": [
								{
									"at": "11.0.0-h3",
									"status": "unaffected"
								},
								{
									"at": "11.0.1-h4",
									"status": "unaffected"
								},
								{
									"at": "11.0.2-h4",
									"status": "unaffected"
								},
								{
									"at": "11.0.3-h10",
									"status": "unaffected"
								},
								{
									"at": "11.0.4-h1",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "11.1",
							"lessThan": "11.1.0-h3",
							"changes": [
								{
									"at": "11.1.0-h3",
									"status": "unaffected"
								},
								{
									"at": "11.1.1-h1",
									"status": "unaffected"
								},
								{
									"at": "11.1.2-h3",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Cloud NGFW",
					"versions": [
						{
							"status": "unaffected",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Prisma Access",
					"versions": [
						{
							"status": "unaffected",
							"version": "All"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-77 Improper Neutralization of Special Elements used in a Command ('Command Injection')",
							"cweId": "CWE-77"
						}
					]
				},
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-20 Improper Input Validation",
							"cweId": "CWE-20"
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H/AU:Y/R:U/V:C/RE:M/U:Red",
						"baseScore": 10,
						"baseSeverity": "CRITICAL",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"attackRequirements": "NONE",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"vulnConfidentialityImpact": "HIGH",
						"vulnIntegrityImpact": "HIGH",
						"vulnAvailabilityImpact": "HIGH",
						"subConfidentialityImpact": "HIGH",
						"subIntegrityImpact": "HIGH",
						"subAvailabilityImpact": "HIGH",
						"Safety": "NOT_DEFINED",
						"Automatable": "YES",
						"Recovery": "USER",
						"valueDensity": "CONCENTRATED",
						"vulnerabilityResponseEffort": "MODERATE",
						"providerUrgency": "RED"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat IDs 95187, 95189, and 95191 (available in Applications and Threats content version 8836-8695 and later). Please monitor this advisory and new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.\n\nTo apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184 for more information.\n\nIn earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Recommended Mitigation: Customers with a Threat Prevention subscription can block attacks for this vulnerability using Threat IDs 95187, 95189, and 95191 (available in Applications and Threats content version 8836-8695 and later). Please monitor this advisory and new Threat Prevention content updates for additional Threat Prevention IDs around CVE-2024-3400.\n\nTo apply the Threat IDs, customers must ensure that vulnerability protection has been applied to their GlobalProtect interface to prevent exploitation of this issue on their device. Please see https://live.paloaltonetworks.com/t5/globalprotect-articles/applying-vulnerability-protection-to-globalprotect-interfaces/ta-p/340184 for more information.\n\nIn earlier versions of this advisory, disabling device telemetry was listed as a secondary mitigation action. Disabling device telemetry is no longer an effective mitigation. Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability."
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.\n\nThis issue is fixed in PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. These fixes and those listed below completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.\n\nIn addition, to provide the most seamless upgrade path for customers, additional hotfixes have been made available as a courtesy for other commonly deployed maintenance releases.\n\n  PAN-OS 10.2:\n  - 10.2.9-h1 (Released 4/14/24)\n  - 10.2.8-h3 (Released 4/15/24)\n  - 10.2.7-h8 (Released 4/15/24)\n  - 10.2.6-h3 (Released 4/16/24)\n  - 10.2.5-h6 (Released 4/16/24)\n  - 10.2.4-h16 (Released 4/18/24)\n  - 10.2.3-h13 (Released 4/18/24)\n  - 10.2.2-h5 (Released 4/18/24)\n  - 10.2.1-h2 (Released 4/18/24)\n  - 10.2.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.0:\n  - 11.0.4-h1 (Released 4/14/24)\n  - 11.0.4-h2 (Released 4/17/24)\n  - 11.0.3-h10 (Released 4/16/24)\n  - 11.0.2-h4 (Released 4/16/24)\n  - 11.0.1-h4 (Released 4/18/24)\n  - 11.0.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.1:\n  - 11.1.2-h3 (Released 4/14/24)\n  - 11.1.1-h1 (Released 4/16/24)\n  - 11.1.0-h3 (Released 4/16/24)\n\nNote: Due to naming convention limitations, “-h” hotfix versions on Azure marketplace are instead named via addition of an extra “0”. Ex: 11.1.2-h3 is published on Azure as 11.1.203.\n\nIf any exploitation was observed on a device, please take the remediation steps suggested here: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK\n\nAn enhanced factory reset (EFR) procedure that does not rely on the integrity of a potentially compromised device can be scheduled by opening a case through Customer Support (TAC). This is recommended for:\n1. Customers who have not applied the PAN-OS fixes or Threat Prevention signatures with vulnerability protection applied to the GlobalProtect interface (regardless of level of compromise) on or before April 25, 2024; or\n2. Customers who are concerned about a persistent risk.\n",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "We strongly advise customers to immediately upgrade to a fixed version of PAN-OS to protect their devices even when workarounds and mitigations have been applied.\n\nThis issue is fixed in PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3, and in all later PAN-OS versions. These fixes and those listed below completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.\n\nIn addition, to provide the most seamless upgrade path for customers, additional hotfixes have been made available as a courtesy for other commonly deployed maintenance releases.\n\n  PAN-OS 10.2:\n  - 10.2.9-h1 (Released 4/14/24)\n  - 10.2.8-h3 (Released 4/15/24)\n  - 10.2.7-h8 (Released 4/15/24)\n  - 10.2.6-h3 (Released 4/16/24)\n  - 10.2.5-h6 (Released 4/16/24)\n  - 10.2.4-h16 (Released 4/18/24)\n  - 10.2.3-h13 (Released 4/18/24)\n  - 10.2.2-h5 (Released 4/18/24)\n  - 10.2.1-h2 (Released 4/18/24)\n  - 10.2.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.0:\n  - 11.0.4-h1 (Released 4/14/24)\n  - 11.0.4-h2 (Released 4/17/24)\n  - 11.0.3-h10 (Released 4/16/24)\n  - 11.0.2-h4 (Released 4/16/24)\n  - 11.0.1-h4 (Released 4/18/24)\n  - 11.0.0-h3 (Released 4/18/24)\n  \n  PAN-OS 11.1:\n  - 11.1.2-h3 (Released 4/14/24)\n  - 11.1.1-h1 (Released 4/16/24)\n  - 11.1.0-h3 (Released 4/16/24)\n\nNote: Due to naming convention limitations, “-h” hotfix versions on Azure marketplace are instead named via addition of an extra “0”. Ex: 11.1.2-h3 is published on Azure as 11.1.203.\n\nIf any exploitation was observed on a device, please take the remediation steps suggested here: https://knowledgebase.paloaltonetworks.com/KCSArticleDetail?id=kA14u000000CrO6CAK\n\nAn enhanced factory reset (EFR) procedure that does not rely on the integrity of a potentially compromised device can be scheduled by opening a case through Customer Support (TAC). This is recommended for:\n1. Customers who have not applied the PAN-OS fixes or Threat Prevention signatures with vulnerability protection applied to the GlobalProtect interface (regardless of level of compromise) on or before April 25, 2024; or\n2. Customers who are concerned about a persistent risk.\n"
					}
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.\n\nWe are also aware of proof-of-concept by third parties of post-exploit persistence techniques that survive resets and upgrades. We are not aware at this time of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability. These fixes listed below and Threat Prevention signatures completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.\n\nMore information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief (https://unit42.paloaltonetworks.com/cve-2024-3400/) and the Palo Alto Networks PSIRT blog post (https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/).",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Palo Alto Networks is aware of an increasing number of attacks that leverage the exploitation of this vulnerability. Proof of concepts for this vulnerability have been publicly disclosed by third parties.\n\nWe are also aware of proof-of-concept by third parties of post-exploit persistence techniques that survive resets and upgrades. We are not aware at this time of any malicious attempts to use these persistence techniques in active exploitation of the vulnerability. These fixes listed below and Threat Prevention signatures completely prevent the initial remote command execution, stopping subsequent post-exploitation or persistence.\n\nMore information about the vulnerability's exploitation in the wild can be found in the Unit 42 threat brief (https://unit42.paloaltonetworks.com/cve-2024-3400/) and the Palo Alto Networks PSIRT blog post (https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/)."
					}
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.\n\nYou can verify whether you have a GlobalProtect gateway or GlobalProtect portal configured by checking for entries in your firewall web interface (Network > GlobalProtect > Gateways or Network > GlobalProtect > Portals).",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0, and PAN-OS 11.1 firewalls configured with GlobalProtect gateway or GlobalProtect portal (or both). Device telemetry does not need to be enabled for PAN-OS firewalls to be exposed to attacks related to this vulnerability.\n\nYou can verify whether you have a GlobalProtect gateway or GlobalProtect portal configured by checking for entries in your firewall web interface (Network > GlobalProtect > Gateways or Network > GlobalProtect > Portals)."
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2024-3400"
				},
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://unit42.paloaltonetworks.com/cve-2024-3400/"
				},
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/"
				},
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://www.paloaltonetworks.com/blog/2024/04/more-on-the-pan-os-cve/"
				}
			],
			"timeline": [
				{
					"time": "2024-04-12T06:55:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				},
				{
					"time": "2024-04-13T05:50:00.000Z",
					"lang": "eng",
					"value": "Added link to Unit42 threat brief and clarified impact to customer-managed VMs in the cloud"
				},
				{
					"time": "2024-04-14T02:50:00.000Z",
					"lang": "eng",
					"value": "Clarified impact on GlobalProtect portal configurations"
				},
				{
					"time": "2024-04-15T02:30:00.000Z",
					"lang": "eng",
					"value": "All necessary PAN-OS fixes are now available, clarified Workarounds and Mitigations when using Panorama templates"
				},
				{
					"time": "2024-04-16T20:45:00.000Z",
					"lang": "eng",
					"value": "Updated product and mitigation guidance, exploit status, and PAN-OS fix availability"
				},
				{
					"time": "2024-04-17T02:00:00.000Z",
					"lang": "eng",
					"value": "Added a CLI command to search for possible attempts of exploit activity"
				},
				{
					"time": "2024-04-17T05:10:00.000Z",
					"lang": "eng",
					"value": "Added new Threat Prevention Threat ID to Workarounds and Mitigations"
				},
				{
					"time": "2024-04-17T22:00:00.000Z",
					"lang": "eng",
					"value": "Clarified FAQ regarding evidence of attempted exploit activity"
				},
				{
					"time": "2024-04-19T01:15:00.000Z",
					"lang": "eng",
					"value": "Clarified vulnerability title and description"
				},
				{
					"time": "2024-04-19T22:25:00.000Z",
					"lang": "eng",
					"value": "Added reference to PSIRT blog post about CVE-2024-3400"
				},
				{
					"time": "2024-04-20T18:23:00.000Z",
					"lang": "eng",
					"value": "Answered a FAQ about Tech Support File collection and forensic evidence"
				},
				{
					"time": "2024-04-25T01:48:00.000Z",
					"lang": "eng",
					"value": "Added link to KB article for remediating a device"
				},
				{
					"time": "2024-04-29T17:58:00.000Z",
					"lang": "eng",
					"value": "Updated exploitation status about proof-of-concept by third parties of post-exploit persistence techniques"
				},
				{
					"time": "2024-05-01T23:45:00.000Z",
					"lang": "eng",
					"value": "Answered a FAQ about how to verify the fix or threat prevention signature was applied correctly"
				},
				{
					"time": "2024-05-03T04:50:00.000Z",
					"lang": "eng",
					"value": "Enhanced Factory Reset (EFR) Procedure is Available Against any Potential Post-Exploit Persistence Techniques."
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks thanks Volexity for detecting and identifying this issue, Capability Development Group at Bishop Fox for helping us improve threat prevention signatures, Nick Wilson, and Louis Lingg for sharing their research into post-exploitation persistence techniques."
				}
			],
			"source": {
				"defect": [
					"PAN-252214"
				],
				"discovery": "USER"
			},
			"datePublic": "2024-04-12T06:55:00.000Z",
			"x_generator": {
				"engine": "vulnogram 0.1.0-rc1"
			},
			"x_affectedList": [
				"PAN-OS 11.1.2-h2",
				"PAN-OS 11.1.2-h1",
				"PAN-OS 11.1.2",
				"PAN-OS 11.1.0-h2",
				"PAN-OS 11.1.0-h1",
				"PAN-OS 11.1.0",
				"PAN-OS 11.1",
				"PAN-OS 11.0.4",
				"PAN-OS 11.0.3-h9",
				"PAN-OS 11.0.3-h8",
				"PAN-OS 11.0.3-h7",
				"PAN-OS 11.0.3-h6",
				"PAN-OS 11.0.3-h5",
				"PAN-OS 11.0.3-h4",
				"PAN-OS 11.0.3-h3",
				"PAN-OS 11.0.3-h2",
				"PAN-OS 11.0.3-h1",
				"PAN-OS 11.0.3",
				"PAN-OS 11.0.2-h3",
				"PAN-OS 11.0.2-h2",
				"PAN-OS 11.0.2-h1",
				"PAN-OS 11.0.2",
				"PAN-OS 11.0.1-h3",
				"PAN-OS 11.0.1-h2",
				"PAN-OS 11.0.1-h1",
				"PAN-OS 11.0.1",
				"PAN-OS 11.0.0-h2",
				"PAN-OS 11.0.0-h1",
				"PAN-OS 11.0.0",
				"PAN-OS 11.0",
				"PAN-OS 10.2.9",
				"PAN-OS 10.2.7-h7",
				"PAN-OS 10.2.7-h6",
				"PAN-OS 10.2.7-h5",
				"PAN-OS 10.2.7-h4",
				"PAN-OS 10.2.7-h3",
				"PAN-OS 10.2.7-h2",
				"PAN-OS 10.2.7-h1",
				"PAN-OS 10.2.7",
				"PAN-OS 10.2.6-h2",
				"PAN-OS 10.2.6-h1",
				"PAN-OS 10.2.6",
				"PAN-OS 10.2.5-h5",
				"PAN-OS 10.2.5-h4",
				"PAN-OS 10.2.5-h3",
				"PAN-OS 10.2.5-h2",
				"PAN-OS 10.2.5-h1",
				"PAN-OS 10.2.5",
				"PAN-OS 10.2.4-h15",
				"PAN-OS 10.2.4-h14",
				"PAN-OS 10.2.4-h13",
				"PAN-OS 10.2.4-h12",
				"PAN-OS 10.2.4-h11",
				"PAN-OS 10.2.4-h10",
				"PAN-OS 10.2.4-h9",
				"PAN-OS 10.2.4-h8",
				"PAN-OS 10.2.4-h7",
				"PAN-OS 10.2.4-h6",
				"PAN-OS 10.2.4-h5",
				"PAN-OS 10.2.4-h4",
				"PAN-OS 10.2.4-h3",
				"PAN-OS 10.2.4-h2",
				"PAN-OS 10.2.4-h1",
				"PAN-OS 10.2.4",
				"PAN-OS 10.2.3-h12",
				"PAN-OS 10.2.3-h11",
				"PAN-OS 10.2.3-h10",
				"PAN-OS 10.2.3-h9",
				"PAN-OS 10.2.3-h8",
				"PAN-OS 10.2.3-h7",
				"PAN-OS 10.2.3-h6",
				"PAN-OS 10.2.3-h5",
				"PAN-OS 10.2.3-h4",
				"PAN-OS 10.2.3-h3",
				"PAN-OS 10.2.3-h2",
				"PAN-OS 10.2.3-h1",
				"PAN-OS 10.2.3",
				"PAN-OS 10.2.2-h4",
				"PAN-OS 10.2.2-h3",
				"PAN-OS 10.2.2-h2",
				"PAN-OS 10.2.2-h1",
				"PAN-OS 10.2.2",
				"PAN-OS 10.2.1-h1",
				"PAN-OS 10.2.1",
				"PAN-OS 10.2.0-h2",
				"PAN-OS 10.2.0-h1",
				"PAN-OS 10.2.0",
				"PAN-OS 10.2"
			]
		}
	}
}
