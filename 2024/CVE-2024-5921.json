{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2024-5921",
		"assignerOrgId": "00000000-0000-4000-9000-000000000000",
		"serial": 1,
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "00000000-0000-4000-9000-000000000000"
			},
			"title": "GlobalProtect App: Insufficient Certificate Validation Leads to Privilege Escalation",
			"descriptions": [
				{
					"lang": "en",
					"value": "An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.\n\nPlease subscribe to our RSS feed (https://security.paloaltonetworks.com/rss.xml) to be alerted to new updates to this and other advisories.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p></p><p>An insufficient certification validation issue in the Palo Alto Networks GlobalProtect app enables attackers to connect the GlobalProtect app to arbitrary servers. This can enable a local non-administrative operating system user or an attacker on the same subnet to install malicious root certificates on the endpoint and subsequently install malicious software signed by the malicious root certificates on that endpoint.</p><p>Please subscribe to <a target=\"_blank\" rel=\"nofollow\" href=\"https://security.paloaltonetworks.com/rss.xml\">our RSS feed</a> to be alerted to new updates to this and other advisories.</p>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"Windows"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.3.0",
							"lessThan": "6.3.2",
							"changes": [
								{
									"at": "6.3.2",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.2.0",
							"lessThan": "6.2.6",
							"changes": [
								{
									"at": "6.2.6",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"macOS"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.3.0",
							"lessThan": "6.3.2",
							"changes": [
								{
									"at": "6.3.2",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.2.0",
							"lessThan": "6.2.6-c857",
							"changes": [
								{
									"at": "6.2.6-c857",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"platforms": [
						"Linux"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.2.0",
							"lessThan": "6.2.1-c31",
							"changes": [
								{
									"at": "6.2.1-c31",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"Android"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0",
							"lessThan": "6.1.6"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"iOS"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1.0",
							"lessThan": "6.1.7",
							"changes": [
								{
									"at": "6.1.7",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"FIPS-CC mode"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.0.0"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.1.0"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"cpes": [
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.3.0:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.4:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.3:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.2:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.1:-:*:*:*:*:*:*",
						"cpe:2.3:a:paloaltonetworks:globalprotect_app:6.2.0:-:*:*:*:*:*:*"
					],
					"platforms": [
						"Windows UWP"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.2.0",
							"lessThan": "6.2.6",
							"changes": [
								{
									"at": "6.2.6",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-295 Improper Certificate Validation",
							"cweId": "CWE-295"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "CAPEC-233 Privilege Escalation"
						}
					],
					"capecId": "CAPEC-233"
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "An attacker on the same subnet as an end user who can influence DNS traffic can cause the user to connect to a malicious GlobalProtect portal."
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:A/AC:L/AT:P/PR:N/UI:P/VC:N/VI:H/VA:N/SC:H/SI:H/SA:H/E:P/AU:N/R:U/V:D/RE:M/U:Amber",
						"baseScore": 7.2,
						"baseSeverity": "HIGH",
						"attackVector": "ADJACENT_NETWORK",
						"attackComplexity": "LOW",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "NONE",
						"userInteraction": "PASSIVE",
						"vulnConfidentialityImpact": "NONE",
						"vulnIntegrityImpact": "HIGH",
						"vulnAvailabilityImpact": "NONE",
						"subConfidentialityImpact": "HIGH",
						"subIntegrityImpact": "HIGH",
						"subAvailabilityImpact": "HIGH",
						"exploitMaturity": "POC",
						"Safety": "NOT_DEFINED",
						"Automatable": "NO",
						"Recovery": "USER",
						"valueDensity": "DIFFUSE",
						"vulnerabilityResponseEffort": "MODERATE",
						"providerUrgency": "AMBER",
						"threatScore": 5.6,
						"threatSeverity": "MEDIUM"
					}
				},
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "A local user with non-administrative privileges connects to a malicious GlobalProtect portal."
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:L/AC:L/AT:P/PR:L/UI:N/VC:N/VI:H/VA:N/SC:H/SI:H/SA:H/E:P/AU:N/R:U/V:D/RE:M/U:Amber",
						"baseScore": 7.1,
						"baseSeverity": "HIGH",
						"attackVector": "LOCAL",
						"attackComplexity": "LOW",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "LOW",
						"userInteraction": "NONE",
						"vulnConfidentialityImpact": "NONE",
						"vulnIntegrityImpact": "HIGH",
						"vulnAvailabilityImpact": "NONE",
						"subConfidentialityImpact": "HIGH",
						"subIntegrityImpact": "HIGH",
						"subAvailabilityImpact": "HIGH",
						"exploitMaturity": "POC",
						"Safety": "NOT_DEFINED",
						"Automatable": "NO",
						"Recovery": "USER",
						"valueDensity": "DIFFUSE",
						"vulnerabilityResponseEffort": "MODERATE",
						"providerUrgency": "AMBER",
						"threatScore": 5.6,
						"threatSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "You can mitigate this issue for all platforms (Windows (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry), macOS (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list), Linux (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat), iOS (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices), Android (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints)) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n\nNote: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>You can mitigate this issue for all platforms (<a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-windows-registry\">Windows</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-using-the-macos-property-list\">macOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-fips-cc-mode-on-linux-endpoints-redhat\">Linux</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-workspaceone-on-ios-devices\">iOS</a>, <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/enable-and-verify-fips-cc-mode/enable-and-verify-fips-cc-mode-using-microsoft-intune-on-android-endpoints\">Android</a>) by using the GlobalProtect app 6.0 in FIPS-CC mode or GlobalProtect app 5.1 in FIPS-CC mode. For details, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</p><p>Note: this is separate from any FIPS-CC configurations on any GlobalProtect portals or gateways. This workaround is specific to FIPS-CC mode on the GlobalProtect app. GlobalProtect portals or gateways do not need to use FIPS-CC mode as part of this workaround.</p>"
						}
					]
				}
			],
			"solutions": [
				{
					"lang": "eng",
					"value": "This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).\n\nThe fix for this vulnerability requires three steps:\n\n 1. Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n 2. Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.\n 3. Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.\n    \n\nNote: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.\n\nImportant: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in our documentation (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues).\n\n\nWarning: Performance Concern: Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office.\n\n\nSolution for new and existing GlobalProtect app installations on Windows\n\nCustomers can use their endpoint mobile device management (MDM) tools to apply the following changes.\n\n 1. Install a fixed version of GlobalProtect app.\n 2. Update the following registry key with the specified recommended values (these values have the REG_SZ type):\n    [HKEY_LOCAL_MACHINE\\SOFTWARE\\Palo Alto Networks\\GlobalProtect\\Settings]\n    \"cert-store\"=\"machine\"\n    \"cert-location\"=\"ROOT\"\n    \"full-chain-cert-verify\"=\"yes\"\n 3. To apply this registry change, restart Windows.\n\nAlternate solution for new GlobalProtect app installations on Windows\n\nInstall the GlobalProtect app with the pre-deployment key FULLCHAINCERTVERIFY set to Yes:\n\n> msiexec.exe /i GlobalProtect64.msi FULLCHAINCERTVERIFY=\"yes\"\n\nNote: This command will add the registry values listed in the previous section (no additional MSI options are needed).\n\n\nSolution for new and existing GlobalProtect app installations on macOS\n\n 1. Install a fixed version of the GlobalProtect app.\n 2. Use Xcode to edit the com.paloaltonetworks.GlobalProtect.settings.plist file (https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-apps/deploy-app-settings-transparently/deploy-app-settings-to-mac-endpoints/deploy-app-settings-in-the-mac-plist) in /Library/Preferences.\n 3. Add a \"Settings\" section if it does not exist within the GlobalProtect section.\n 4. Within the \"Settings\" section, add the full-chain-cert-verify key and set the string value to yes.\n    <key>GlobalProtect</key>\n    <dict>\n        (removed for brevity)\n        <key>Settings</key>\n        <dict>\n            <key>full-chain-cert-verify</key>\n            <string>yes</string>\n        </dict>\n    </dict>\n 5. Restart macOS.\n\nSolution for new and existing GlobalProtect app installations on Linux\n\n 1. Create the /opt/paloaltonetworks/globalprotect/pangps.xml pre-deployment configuration file.\n 2. Add the pre-deployment settings to the pangps.xml file:\n    <GlobalProtect>\n        <Settings>\n            <full-chain-cert-verify>yes</full-chain-cert-verify>\n        </Settings>\n    </GlobalProtect>\n 3. Install a fixed version of GlobalProtect app.\n\nSolution for new and existing GlobalProtect app installations on Android and iOS\n\nCustomers can use their endpoint mobile device management (MDM) tools to apply the following changes.\n 1. Set the key \"full-chain-cert-verify\"=\"yes\". \n 2. Install a fixed version of GlobalProtect app for Android or iOS.\n",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>This issue is fixed in GlobalProtect app 6.2.1-c31 on Linux, GlobalProtect app 6.2.6 on Windows, GlobalProtect app 6.2.6-c857 on macOS, GlobalProtect app 6.3.2 on Windows and macOS, and all later GlobalProtect app versions. Additional fixes are under development and will be made available for the remaining platforms (Linux, iOS, and Android).</p>The fix for this vulnerability requires three steps:<br><ol><li>Ensure that all of your GlobalProtect portals use TLS certificate chains that meet the criteria specified in the \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.</li><li>Ensure that the TLS certificate chains used by the GlobalProtect portals are added to the root certificate store in your operating system.</li><li>Install a fixed version of GlobalProtect using one of the deployment options below. This setting enforces strict X.509v3 verification checks on the certificate provided by the GlobalProtect portal.<br></li></ol><p>Note: Prisma Access customers using portals with a *.gpcloudservice.com domain name already have valid TLS certificate chains. The root certificate for these portals is from GoDaddy, which is trusted by default in Windows, macOS, RHEL, Ubuntu, iOS, and Android. Therefore, Prisma Access customers using a GlobalProtect portal with a *.gpcloudservice.com domain name should only need to perform step 3 above.<br><br><b>Important</b>: If your GlobalProtect portals do not use valid X.509V3 TLS certificate chains, this will result in TLS verification failures. To generate a GlobalProtect portal certificate that can be used with a fixed version of GlobalProtect app, refer to the first \"FIPS-CC Certification Validation\" table in <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/certifications/resolve-fips-cc-mode-issues\">our documentation</a>.<b><br></b></p><p><b></b><b></b><b>Warning: Performance Concern:</b> Some customers reported problems connecting to Portals and Gateways when this solution was implemented in certain situations. This is due to certificate providers that rate limit requests for Online Certificate Status Protocol (OCSP) and certificate revocation list (CRL) checks. This happens when multiple users connect to GlobalProtect Portals from a single public IP (such as NAT) around the same time, such as when hundreds or thousands of end users connect around the start of a workday from a single office. <br></p><p><b>Solution for new and existing GlobalProtect app installations on Windows</b></p><p>Customers can use their endpoint mobile device management (MDM) tools to apply the following changes.</p><ol><li>Install a fixed version of GlobalProtect app.</li><li>Update the following registry key with the specified recommended values (these values have the REG_SZ type):<br><tt><tt>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Palo Alto Networks\\GlobalProtect\\Settings]<br></tt>\"cert-store\"=\"machine\"<br>\"cert-location\"=\"ROOT\"<br>\"full-chain-cert-verify\"=\"yes\"</tt></li><li>To apply this registry change, restart Windows.</li></ol><p><b>Alternate solution for new GlobalProtect app installations on Windows</b></p><p>Install the GlobalProtect app with the pre-deployment key FULLCHAINCERTVERIFY set to Yes:</p><blockquote><tt>msiexec.exe /i GlobalProtect64.msi FULLCHAINCERTVERIFY=\"yes\"</tt></blockquote>Note: This command will add the registry values listed in the previous section (no additional MSI options are needed).<br><b><p>Solution for new and existing GlobalProtect app installations on macOS</p></b><ol><li>Install a fixed version of the GlobalProtect app.</li><li><a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-apps/deploy-app-settings-transparently/deploy-app-settings-to-mac-endpoints/deploy-app-settings-in-the-mac-plist\">Use Xcode to edit the com.paloaltonetworks.GlobalProtect.settings.plist file</a>&nbsp;in /Library/Preferences.</li><li>Add a \"Settings\" section if it does not exist within the GlobalProtect section.</li><li>Within the \"Settings\" section, add the full-chain-cert-verify key and set the string value to yes.<br><tt>&lt;key&gt;GlobalProtect&lt;/key&gt;<br>&lt;dict&gt;<br>&nbsp; &nbsp; (removed for brevity)<br><b>&nbsp; &nbsp; &lt;key&gt;Settings&lt;/key&gt;</b><br><b>&nbsp; &nbsp; &lt;dict&gt;</b><br><b>&nbsp; &nbsp; &nbsp; &nbsp; &lt;key&gt;full-chain-cert-verify&lt;/key&gt;</b><br><b>&nbsp; &nbsp; &nbsp; &nbsp; &lt;string&gt;yes&lt;/string&gt;</b><br><b>&nbsp; &nbsp; &lt;/dict&gt;</b><br>&lt;/dict&gt;</tt></li><li>Restart macOS.</li></ol><div><b>Solution for new and existing GlobalProtect app installations on Linux<br></b><ol><li>Create the /opt/paloaltonetworks/globalprotect/pangps.xml pre-deployment configuration file.</li><li>Add the pre-deployment settings to the pangps.xml file:<tt><br>&lt;GlobalProtect&gt;<br>&nbsp; &nbsp; &lt;Settings&gt;<br>&nbsp; &nbsp; &nbsp; &nbsp; &lt;full-chain-cert-verify&gt;yes&lt;/full-chain-cert-verify&gt;<br>&nbsp; &nbsp; &lt;/Settings&gt; <br>&lt;/GlobalProtect&gt;</tt></li><li>Install a fixed version of GlobalProtect app.</li></ol><p><b>Solution for new and existing GlobalProtect app installations on Android and iOS</b></p>Customers can use their endpoint mobile device management (MDM) tools to apply the following changes.<ol><li>Set the key&nbsp;<tt>\"full-chain-cert-verify\"=\"yes\".&nbsp;</tt></li><li>Install a fixed version of GlobalProtect app for Android or iOS.</li></ol><br></div>"
						}
					]
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available.\n",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>Palo Alto Networks is not aware of any malicious exploitation of this issue. We are aware of a publicly available conference talk and blog posts discussing this issue. A proof of concept for this issue is also publicly available.<br></p>"
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "No special configuration is required to be affected by this issue.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "No special configuration is required to be affected by this issue."
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"vendor-advisory"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2024-5921"
				},
				{
					"tags": [
						"exploit"
					],
					"url": "https://blog.amberwolf.com/blog/2024/november/palo-alto-globalprotect---code-execution-and-privilege-escalation-via-malicious-vpn-server-cve-2024-5921/"
				},
				{
					"tags": [
						"exploit"
					],
					"url": "https://github.com/AmberWolfCyber/NachoVPN"
				}
			],
			"timeline": [
				{
					"time": "2024-11-26T02:45:00.000Z",
					"lang": "en",
					"value": "Initial publication"
				},
				{
					"time": "2024-11-26T20:15:00.000Z",
					"lang": "en",
					"value": "Clarified impact, solution, and added frequently asked questions"
				},
				{
					"time": "2024-11-27T03:35:00.000Z",
					"lang": "en",
					"value": "Added registry-based deployment option to solution, and added frequently asked questions"
				},
				{
					"time": "2024-12-06T17:15:00.000Z",
					"lang": "en",
					"value": "Updated affected products, added ETAs, clarified solution, and added frequently asked questions"
				},
				{
					"time": "2024-12-13T21:50:00.000Z",
					"lang": "en",
					"value": "Added note to the solution about potential performance concern"
				},
				{
					"time": "2024-12-16T18:00:00.000Z",
					"lang": "en",
					"value": "Updated planned fix version and ETA for 6.3 for Windows and macOS"
				},
				{
					"time": "2024-12-19T07:00:00.000Z",
					"lang": "en",
					"value": "Updated ETAs for GlobalProtect app versions 6.3, 6.2, and 6.1"
				},
				{
					"time": "2024-12-24T22:00:00.000Z",
					"lang": "en",
					"value": "Updated product status table for GlobalProtect app 6.3.2 and added macOS solution"
				},
				{
					"time": "2025-01-13T19:00:00.000Z",
					"lang": "en",
					"value": "Added planned fix version and ETA for 6.1 for Android"
				},
				{
					"time": "2025-01-17T18:00:00.000Z",
					"lang": "en",
					"value": "Added 6.2.6-c857 macOS solution"
				},
				{
					"time": "2025-02-05T16:25:00.000Z",
					"lang": "en",
					"value": "Updated ETA for 6.2.1-HF2 Linux, 6.1.6 Android, 6.1.7 iOS, and 6.2.6 UWP"
				},
				{
					"time": "2025-02-20T22:20:00.000Z",
					"lang": "en",
					"value": "Updated fix availability for 6.2.1 on Linux and solutions section to provide steps needed for Linux"
				},
				{
					"time": "2025-03-06T17:15:00.000Z",
					"lang": "en",
					"value": "Updated fix availability for Android, iOS and solutions section to provide steps needed for Android, iOS"
				},
				{
					"time": "2025-03-19T19:40:00.000Z",
					"lang": "en",
					"value": "Updated ETA for GlobalProtect UWP App 6.2.6"
				}
			],
			"credits": [
				{
					"type": "finder",
					"lang": "en",
					"value": "Maxime ESCOURBIAC, Michelin CERT"
				},
				{
					"type": "finder",
					"lang": "en",
					"value": "Yassine BENGANA, Abicom for Michelin CERT"
				},
				{
					"type": "finder",
					"lang": "en",
					"value": "Richard Warren and David Cash of AmberWolf"
				}
			],
			"source": {
				"defect": [
					"GPC-19860",
					"GPC-19861"
				],
				"discovery": "EXTERNAL"
			},
			"datePublic": "2024-11-26T02:45:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.1.0-dev"
			},
			"x_affectedList": [
				"GlobalProtect App 6.3.1",
				"GlobalProtect App 6.3.0",
				"GlobalProtect App 6.3",
				"GlobalProtect App 6.2.4",
				"GlobalProtect App 6.2.3",
				"GlobalProtect App 6.2.2",
				"GlobalProtect App 6.2.1",
				"GlobalProtect App 6.2.0",
				"GlobalProtect App 6.2"
			]
		}
	}
}
