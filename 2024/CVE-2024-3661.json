{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2024-3661",
		"assignerOrgId": "00000000-0000-4000-9000-000000000000",
		"assignerShortName": "palo_alto",
		"serial": 1,
		"state": "PUBLISHED",
		"datePublished": "2024-05-16T07:00:00.000Z",
		"dateUpdated": "2024-05-16T00:00:00.000Z",
		"dateReserved": "2024-05-16T07:00:00.000Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "00000000-0000-4000-9000-000000000000",
				"shortName": "cisa-cg",
				"dateUpdated": "2024-07-01T15:04:00.000Z"
			},
			"title": "Impact of TunnelVision Vulnerability",
			"descriptions": [
				{
					"lang": "en",
					"value": "The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages on the same local area network, such as a rogue Wi-Fi network, to leak traffic outside of the GlobalProtect tunnel, allowing the attacker to read, disrupt, or possibly modify network traffic that was expected to be protected by the GlobalProtect tunnel. However, this attack does not enable the attacker to decrypt HTTPS or other encrypted traffic.\n\nCloud NGFW, PAN-OS, and Prisma Access do not process DHCP option 121 and are therefore unaffected.\n\nGlobalProtect app on Windows and macOS systems with Endpoint Traffic Policy Enforcement enabled are unaffected. Endpoint Traffic Policy Enforcement is disabled by default.\n\nGlobalProtect app on Linux is affected. A fix will be released in an upcoming release.\n\nGlobalProtect app on iOS with IncludeAllNetworks set to 1 is unaffected.\n\nGlobalProtect app on Android is unaffected since the Android DHCP client does not process DHCP option 121.",
					"supportingMedia": [
						{
							"base64": true,
							"type": "text/html",
							"value": "<p>The Palo Alto Networks Product Security Assurance team has evaluated the TunnelVision vulnerability as it relates to our products. This issue allows an attacker with the ability to send DHCP messages on the same local area network, such as a rogue Wi-Fi network, to leak traffic outside of the GlobalProtect tunnel, allowing the attacker to read, disrupt, or possibly modify network traffic that was expected to be protected by the GlobalProtect tunnel. However, this attack does not enable the attacker to decrypt HTTPS or other encrypted traffic.</p><p>Cloud NGFW, PAN-OS, and Prisma Access do not process DHCP option 121 and are therefore unaffected.</p><p>GlobalProtect app on Windows and macOS systems with Endpoint Traffic Policy Enforcement enabled are unaffected. Endpoint Traffic Policy Enforcement is disabled by default.</p><p>GlobalProtect app on Linux is affected. A fix will be released in an upcoming release.</p><p>GlobalProtect app on iOS with IncludeAllNetworks set to 1 is unaffected.</p><p>GlobalProtect app on Android is unaffected since the Android DHCP client does not process DHCP option 121.</p>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "Cloud NGFW",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"platforms": [
						"Windows",
						"macOS"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "All without Endpoint Traffic Policy Enforcement set to All Traffic",
							"lessThan": "All with Endpoint Traffic Policy Enforcement set to All Traffic",
							"changes": [
								{
									"at": "All with Endpoint Traffic Policy Enforcement set to All Traffic",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"platforms": [
						"Linux"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "All",
							"lessThan": "Upcoming major release",
							"changes": [
								{
									"at": "Upcoming major release",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"platforms": [
						"iOS"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "All with IncludeAllNetworks set to 1",
							"lessThan": "All without IncludeAllNetworks set to 1",
							"changes": [
								{
									"at": "All without IncludeAllNetworks set to 1",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "GlobalProtect App",
					"platforms": [
						"Android"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "PAN-OS",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Prisma Access",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "All"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-501 Trust Boundary Violation",
							"cweId": "CWE-501"
						}
					]
				},
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-306 Missing Authentication for Critical Function",
							"cweId": "CWE-306"
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:A/AC:H/AT:P/PR:N/UI:P/VC:L/VI:L/VA:L/SC:N/SI:N/SA:N/AU:Y/R:A/V:D/RE:M/U:Green",
						"baseScore": 2.1,
						"baseSeverity": "LOW",
						"attackVector": "ADJACENT_NETWORK",
						"attackComplexity": "HIGH",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "NONE",
						"userInteraction": "PASSIVE",
						"vulnConfidentialityImpact": "LOW",
						"vulnIntegrityImpact": "LOW",
						"vulnAvailabilityImpact": "LOW",
						"subConfidentialityImpact": "NONE",
						"subIntegrityImpact": "NONE",
						"subAvailabilityImpact": "NONE",
						"exploitMaturity": "NOT_DEFINED",
						"Safety": "NOT_DEFINED",
						"Automatable": "YES",
						"Recovery": "AUTOMATIC",
						"valueDensity": "DIFFUSE",
						"vulnerabilityResponseEffort": "MODERATE",
						"providerUrgency": "GREEN",
						"threatScore": 2.1,
						"threatSeverity": "LOW"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "For the GlobalProtect app on Windows, macOS, and Linux, this attack can be mitigated by enabling the \"No direct access to local network\" feature in the Split Tunnel tab on the firewall. Detailed information can be found at:\n\n\n\n * https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab\n * https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network\n\n\n\nNote that enabling \"No direct access to local network\" prevents end users from connecting to local LAN devices such as home printers, network storage, or streaming devices. You can configure exceptions for specific users, operating systems, source addresses, destination domains, and applications by following the instructions at:\n\n\n\n * https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route\n * https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application\n\n\n\nYou can mitigate this attack for the GlobalProtect app on iOS devices by disabling Wi-Fi.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>For the GlobalProtect app on Windows, macOS, and Linux, this attack can be mitigated by enabling the \"No direct access to local network\" feature in the Split Tunnel tab on the firewall. Detailed information can be found at:</p><p></p><ul><li><a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab\">https://docs.paloaltonetworks.com/pan-os/11-0/pan-os-web-interface-help/globalprotect/network-globalprotect-gateways/globalprotect-gateways-agent-tab/client-settings-tab</a></li><li><a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network\">https://docs.paloaltonetworks.com/prisma/prisma-access/3-0/prisma-access-panorama-admin/prisma-access-advanced-deployments/mobile-user-globalprotect-advanced-deployments/sinkhole-ipv6-traffic-from-mobile-users/configure-globalprotect-to-disable-direct-access-to-the-local-network</a></li></ul><p></p><p>Note that enabling \"No direct access to local network\" prevents end users from connecting to local LAN devices such as home printers, network storage, or streaming devices. You can configure exceptions for specific users, operating systems, source addresses, destination domains, and applications by following the instructions at:</p><p></p><ul><li><a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route\">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-access-route</a></li><li><a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application\">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/globalprotect-gateways/split-tunnel-traffic-on-globalprotect-gateways/configure-a-split-tunnel-based-on-the-domain-and-application</a></li></ul><p></p><p>You can mitigate this attack for the GlobalProtect app on iOS devices by disabling Wi-Fi.</p>"
						}
					]
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "For Windows and macOS devices, ensure that Endpoint Traffic Policy Enforcement is set to All Traffic (Network → GlobalProtect Portals → <portal-config> → Agent → <agent-config> → App → Endpoint Traffic Policy Enforcement). Please see the following document for additional details: https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement.\n\nFor iOS devices, ensure that IncludeAllNetworks is set to 1 using mobile device management. For additional guidance, please see our mobile device management documentation at https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management and the Apple documentation at https://developer.apple.com/documentation/devicemanagement/vpn/vpn. To allow users to access their local network, ensure that ExcludeLocalNetwork is set to 1, so that the GlobalProtect app will route all local network traffic outside the tunnel.\n\nUpdates will be released for the GlobalProtect app on Linux in an upcoming major release.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>For Windows and macOS devices, ensure that Endpoint Traffic Policy Enforcement is set to All Traffic (Network → GlobalProtect Portals → &lt;portal-config&gt; → Agent → &lt;agent-config&gt; → App → Endpoint Traffic Policy Enforcement). Please see the following document for additional details: <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement\">https://docs.paloaltonetworks.com/globalprotect/6-0/globalprotect-app-new-features/new-features-released-in-gp-app/endpoint-traffic-policy-enforcement</a>.</p><p>For iOS devices, ensure that IncludeAllNetworks is set to 1 using mobile device management. For additional guidance, please see our mobile device management documentation at <a target=\"_blank\" rel=\"nofollow\" href=\"https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management\">https://docs.paloaltonetworks.com/globalprotect/10-1/globalprotect-admin/mobile-endpoint-management</a>&nbsp;and the Apple documentation at <a target=\"_blank\" rel=\"nofollow\" href=\"https://developer.apple.com/documentation/devicemanagement/vpn/vpn\">https://developer.apple.com/documentation/devicemanagement/vpn/vpn</a>. To allow users to access their local network, ensure that ExcludeLocalNetwork is set to 1, so that the GlobalProtect app will route all local network traffic outside the tunnel.</p><p>Updates will be released for the GlobalProtect app on Linux in an upcoming major release.</p>"
						}
					]
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue in any of our products.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue in any of our products."
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "No special configuration is required to be affected by this issue.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "No special configuration is required to be affected by this issue."
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2024-3661"
				}
			],
			"timeline": [
				{
					"time": "2024-05-16T16:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				}
			],
			"source": {
				"discovery": "EXTERNAL"
			},
			"datePublic": "2024-05-16T16:00:00.000Z",
			"x_generator": {
				"engine": "vulnogram 0.1.0-rc1"
			},
			"x_affectedList": [
				"GlobalProtect app on Windows and macOS",
				"GlobalProtect app on Linux",
				"GlobalProtect app on iOS"
			]
		}
	}
}
