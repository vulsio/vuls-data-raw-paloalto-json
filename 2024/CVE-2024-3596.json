{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2024-3596",
		"assignerOrgId": "00000000-0000-4000-9000-000000000000",
		"assignerShortName": "palo_alto",
		"serial": 1,
		"state": "PUBLISHED",
		"datePublished": "2024-07-10T07:00:00.000Z",
		"dateUpdated": "2024-07-26T00:00:00.000Z",
		"dateReserved": "2024-07-10T07:00:00.000Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "37e5125f-f79b-445b-8fad-9564f167944b",
				"shortName": "certcc",
				"dateUpdated": "2024-07-09T14:08:23.145Z"
			},
			"title": "PAN-OS: CHAP and PAP When Used with RADIUS Authentication Lead to Privilege Escalation",
			"descriptions": [
				{
					"lang": "en",
					"value": "This vulnerability allows an attacker performing a meddler-in-the-middle attack between Palo Alto Networks PAN-OS firewall and a RADIUS server to bypass authentication and escalate privileges to ‘superuser’ when RADIUS authentication is in use and either CHAP or PAP is selected in the RADIUS server profile.\n\nCHAP and PAP are protocols with no Transport Layer Security (TLS), and hence vulnerable to meddler-in-the-middle attacks. Neither protocol should be used unless they are encapsulated by an encrypted tunnel. If they are in use, but are encapsulated within a TLS tunnel, they are not vulnerable to this attack.\n\nFor additional information regarding this vulnerability, please see https://blastradius.fail.",
					"supportingMedia": [
						{
							"base64": true,
							"type": "text/html",
							"value": "<p>This vulnerability allows an attacker performing a meddler-in-the-middle attack between Palo Alto Networks PAN-OS firewall and a RADIUS server to bypass authentication and escalate privileges to ‘superuser’ when RADIUS authentication is in use and either CHAP or PAP is selected in the RADIUS server profile.</p><p>CHAP and PAP are protocols with no Transport Layer Security (TLS), and hence vulnerable to meddler-in-the-middle attacks. Neither protocol should be used unless they are encapsulated by an encrypted tunnel. If they are in use, but are encapsulated within a TLS tunnel, they are not vulnerable to this attack.</p><p>For additional information regarding this vulnerability, please see <a>https://blastradius.fail</a>.</p>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "PAN-OS",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"version": "11.2.0"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "11.1.0",
							"lessThan": "11.1.3",
							"changes": [
								{
									"at": "11.1.3",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.2.0",
							"lessThan": "10.2.10",
							"changes": [
								{
									"at": "10.2.10",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.1.0",
							"lessThan": "10.1.14",
							"changes": [
								{
									"at": "10.1.14",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "11.0.0",
							"lessThan": "11.0.4-h5",
							"changes": [
								{
									"at": "11.0.4-h5",
									"status": "unaffected"
								},
								{
									"at": "11.0.6",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "9.1.0",
							"lessThan": "9.1.19",
							"changes": [
								{
									"at": "9.1.19",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Cloud NGFW",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "unaffected",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Prisma Access",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"version": "All",
							"lessThan": "None (Fix ETA: September 15)"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-290 Authentication Bypass by Spoofing",
							"cweId": "CWE-290"
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:N/AC:H/AT:P/PR:N/UI:P/VC:N/VI:N/VA:N/SC:H/SI:H/SA:N/AU:N/R:A/V:C/RE:M/U:Amber",
						"baseScore": 5.3,
						"baseSeverity": "MEDIUM",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "NONE",
						"userInteraction": "PASSIVE",
						"vulnConfidentialityImpact": "NONE",
						"vulnIntegrityImpact": "NONE",
						"vulnAvailabilityImpact": "NONE",
						"subConfidentialityImpact": "HIGH",
						"subIntegrityImpact": "HIGH",
						"subAvailabilityImpact": "NONE",
						"exploitMaturity": "NOT_DEFINED",
						"Safety": "NOT_DEFINED",
						"Automatable": "NO",
						"Recovery": "AUTOMATIC",
						"valueDensity": "CONCENTRATED",
						"vulnerabilityResponseEffort": "MODERATE",
						"providerUrgency": "AMBER"
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "The best way to address this issue is by using encrypted and authenticated channels that offer modern cryptographic security guarantees.\n\nConfigure an alternate authentication mechanism if you are using RADIUS with a CHAP or PAP authentication protocol. PAN-OS provides the following alternate RADIUS authentication mechanisms: PEAP-MSCHAPv2 (default), PEAP with GTC, and EAP-TTLS with PAP. For more information, please see https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication/configure-radius-authentication.\n\nIn addition, instead of using RADIUS, you can configure an alternate authentication mechanism using one of the options described here: https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication.\n\nIf you are a Prisma Access customer using a RADIUS configuration with PAP or CHAP in your profile and have not applied one of the changes described above, please reach out to TAC/CS to schedule an upgrade window.\n\nPAN-OS 9.1.19, PAN-OS 10.1.14, PAN-OS 10.2.10, PAN-OS 11.0.7, PAN-OS 11.1.3, and all later PAN-OS versions add a new feature to enforce an authentication check in RADIUS. This new feature is disabled by default to match the existing behavior. To enable this feature, run the following commands:\n\n> set auth radius-require-msg-authentic yes\n\nTo confirm that the setting was correctly enabled, run the following command:\n\n> show auth radius-require-msg-authentic\n\nIf set correctly, the response will say \"yes\". This setting is persistent across reboots. No ‘commit’ is required for this to take effect.\n\nPlease note that this feature requires that the RADIUS server has been updated to support the new protocol changes, as detailed in https://kb.cert.org/vuls/id/456537. If your RADIUS authentication breaks when radius-require-msg-authentic is set to yes, please work with your RADIUS server vendor for support with the RADIUS server upgrade process.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "<p>The best way to address this issue is by using encrypted and authenticated channels that offer modern cryptographic security guarantees.</p><p>Configure an alternate authentication mechanism if you are using RADIUS with a CHAP or PAP authentication protocol. PAN-OS provides the following alternate RADIUS authentication mechanisms: PEAP-MSCHAPv2 (default), PEAP with GTC, and EAP-TTLS with PAP. For more information, please see <a>https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication/configure-radius-authentication</a>.</p><p>In addition, instead of using RADIUS, you can configure an alternate authentication mechanism using one of the options described here: <a>https://docs.paloaltonetworks.com/pan-os/11-1/pan-os-admin/authentication</a>.</p><p>If you are a Prisma Access customer using a RADIUS configuration with PAP or CHAP in your profile and have not applied one of the changes described above, please reach out to TAC/CS to schedule an upgrade window.</p><p>PAN-OS 9.1.19, PAN-OS 10.1.14, PAN-OS 10.2.10, PAN-OS 11.0.7, PAN-OS 11.1.3, and all later PAN-OS versions add a new feature to enforce an authentication check in RADIUS. This new feature is disabled by default to match the existing behavior. To enable this feature, run the following commands:</p><blockquote><tt>set auth radius-require-msg-authentic yes</tt></blockquote><p>To confirm that the setting was correctly enabled, run the following command:</p><blockquote><tt>show auth radius-require-msg-authentic</tt></blockquote><p>If set correctly, the response will say \"yes\". This setting is persistent across reboots. No ‘commit’ is required for this to take effect.</p><p>Please note that this feature requires that the RADIUS server has been updated to support the new protocol changes, as detailed in <a>https://kb.cert.org/vuls/id/456537</a>. If your RADIUS authentication breaks when radius-require-msg-authentic is set to yes, please work with your RADIUS server vendor for support with the RADIUS server upgrade process.</p>"
						}
					]
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is aware of proof of concept code demonstrating how to exploit this generic issue.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "Palo Alto Networks is aware of proof of concept code demonstrating how to exploit this generic issue."
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "To be vulnerable, Palo Alto Networks PAN-OS firewalls must be configured to use CHAP or PAP as the authentication protocol for a RADIUS server. Note that PAP differs from EAP-TTLS with PAP, which is not vulnerable to this attack.",
					"supportingMedia": [
						{
							"base64": false,
							"type": "text/html",
							"value": "To be vulnerable, Palo Alto Networks PAN-OS firewalls must be configured to use CHAP or PAP as the authentication protocol for a RADIUS server. Note that PAP differs from EAP-TTLS with PAP, which is not vulnerable to this attack."
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2024-3596"
				}
			],
			"timeline": [
				{
					"time": "2024-07-10T16:00:00.000Z",
					"lang": "eng",
					"value": "Initial publication"
				},
				{
					"time": "2024-07-16T23:00:00.000Z",
					"lang": "eng",
					"value": "Clarified versions for 11.0 branch"
				},
				{
					"time": "2024-07-26T05:00:00.000Z",
					"lang": "eng",
					"value": "Clarified requirements for RADIUS server"
				}
			],
			"credits": [
				{
					"type": "finder",
					"lang": "en",
					"value": "Palo Alto Networks thanks Sharon Goldberg, Miro Haller, Nadia Heninger, Mike Milano, Dan Shumow, Marc Stevens, and Adam Suhl for discovering and reporting this issue."
				}
			],
			"source": {
				"defect": [
					"PAN-247511"
				],
				"discovery": "EXTERNAL"
			},
			"datePublic": "2024-07-10T16:00:00.000Z",
			"x_generator": {
				"engine": "vulnogram 0.1.0-rc1"
			},
			"x_affectedList": [
				"Prisma Access",
				"PAN-OS 11.2",
				"PAN-OS 11.1.2-h4",
				"PAN-OS 11.1.2-h3",
				"PAN-OS 11.1.2-h2",
				"PAN-OS 11.1.2-h1",
				"PAN-OS 11.1.2",
				"PAN-OS 11.1.0",
				"PAN-OS 11.1",
				"PAN-OS 11.0.4",
				"PAN-OS 11.0.3-h12",
				"PAN-OS 11.0.3-h11",
				"PAN-OS 11.0.3-h10",
				"PAN-OS 11.0.3-h9",
				"PAN-OS 11.0.3-h8",
				"PAN-OS 11.0.3-h7",
				"PAN-OS 11.0.3-h6",
				"PAN-OS 11.0.3-h5",
				"PAN-OS 11.0.3-h4",
				"PAN-OS 11.0.3-h3",
				"PAN-OS 11.0.3-h2",
				"PAN-OS 11.0.3-h1",
				"PAN-OS 11.0.3",
				"PAN-OS 11.0.2-h2",
				"PAN-OS 11.0.2-h1",
				"PAN-OS 11.0.2",
				"PAN-OS 11.0.1-h2",
				"PAN-OS 11.0.1-h1",
				"PAN-OS 11.0.1",
				"PAN-OS 11.0.0-h1",
				"PAN-OS 11.0.0",
				"PAN-OS 11.0",
				"PAN-OS 10.2.9",
				"PAN-OS 10.2.8-h4",
				"PAN-OS 10.2.8-h3",
				"PAN-OS 10.2.8-h2",
				"PAN-OS 10.2.8-h1",
				"PAN-OS 10.2.8",
				"PAN-OS 10.2.7-h6",
				"PAN-OS 10.2.7-h5",
				"PAN-OS 10.2.7-h4",
				"PAN-OS 10.2.7-h3",
				"PAN-OS 10.2.7-h2",
				"PAN-OS 10.2.7-h1",
				"PAN-OS 10.2.7",
				"PAN-OS 10.2.6",
				"PAN-OS 10.2.5",
				"PAN-OS 10.2.4-h4",
				"PAN-OS 10.2.4-h3",
				"PAN-OS 10.2.4-h2",
				"PAN-OS 10.2.4-h1",
				"PAN-OS 10.2.4",
				"PAN-OS 10.2.3-h11",
				"PAN-OS 10.2.3-h10",
				"PAN-OS 10.2.3-h9",
				"PAN-OS 10.2.3-h8",
				"PAN-OS 10.2.3-h7",
				"PAN-OS 10.2.3-h6",
				"PAN-OS 10.2.3-h5",
				"PAN-OS 10.2.3-h4",
				"PAN-OS 10.2.3-h3",
				"PAN-OS 10.2.3-h2",
				"PAN-OS 10.2.3-h1",
				"PAN-OS 10.2.3",
				"PAN-OS 10.2.2-h2",
				"PAN-OS 10.2.2-h1",
				"PAN-OS 10.2.2",
				"PAN-OS 10.2.1",
				"PAN-OS 10.2.0",
				"PAN-OS 10.2",
				"PAN-OS 10.1.13-h1",
				"PAN-OS 10.1.12",
				"PAN-OS 10.1.11-h5",
				"PAN-OS 10.1.11-h4",
				"PAN-OS 10.1.11-h3",
				"PAN-OS 10.1.11-h2",
				"PAN-OS 10.1.11-h1",
				"PAN-OS 10.1.11",
				"PAN-OS 10.1.10-h2",
				"PAN-OS 10.1.10-h1",
				"PAN-OS 10.1.10",
				"PAN-OS 10.1.9-h3",
				"PAN-OS 10.1.9-h2",
				"PAN-OS 10.1.9-h1",
				"PAN-OS 10.1.9",
				"PAN-OS 10.1.8-h6",
				"PAN-OS 10.1.8-h5",
				"PAN-OS 10.1.8-h4",
				"PAN-OS 10.1.8-h3",
				"PAN-OS 10.1.8-h2",
				"PAN-OS 10.1.8-h1",
				"PAN-OS 10.1.8",
				"PAN-OS 10.1.7",
				"PAN-OS 10.1.6-h7",
				"PAN-OS 10.1.6-h6",
				"PAN-OS 10.1.6-h5",
				"PAN-OS 10.1.6-h4",
				"PAN-OS 10.1.6-h3",
				"PAN-OS 10.1.6-h2",
				"PAN-OS 10.1.6-h1",
				"PAN-OS 10.1.6",
				"PAN-OS 10.1.5-h3",
				"PAN-OS 10.1.5-h2",
				"PAN-OS 10.1.5-h1",
				"PAN-OS 10.1.5",
				"PAN-OS 10.1.4-h4",
				"PAN-OS 10.1.4-h3",
				"PAN-OS 10.1.4-h2",
				"PAN-OS 10.1.4-h1",
				"PAN-OS 10.1.4",
				"PAN-OS 10.1.3-h2",
				"PAN-OS 10.1.3-h1",
				"PAN-OS 10.1.3",
				"PAN-OS 10.1.2",
				"PAN-OS 10.1.1",
				"PAN-OS 10.1.0",
				"PAN-OS 10.1",
				"PAN-OS 9.1.16-h3",
				"PAN-OS 9.1.16-h2",
				"PAN-OS 9.1.16-h1",
				"PAN-OS 9.1.16",
				"PAN-OS 9.1.15-h1",
				"PAN-OS 9.1.15",
				"PAN-OS 9.1.14-h7",
				"PAN-OS 9.1.14-h6",
				"PAN-OS 9.1.14-h5",
				"PAN-OS 9.1.14-h4",
				"PAN-OS 9.1.14-h3",
				"PAN-OS 9.1.14-h2",
				"PAN-OS 9.1.14-h1",
				"PAN-OS 9.1.14",
				"PAN-OS 9.1.13-h4",
				"PAN-OS 9.1.13-h3",
				"PAN-OS 9.1.13-h2",
				"PAN-OS 9.1.13-h1",
				"PAN-OS 9.1.13",
				"PAN-OS 9.1.12-h6",
				"PAN-OS 9.1.12-h5",
				"PAN-OS 9.1.12-h4",
				"PAN-OS 9.1.12-h3",
				"PAN-OS 9.1.12-h2",
				"PAN-OS 9.1.12-h1",
				"PAN-OS 9.1.12",
				"PAN-OS 9.1.11-h4",
				"PAN-OS 9.1.11-h3",
				"PAN-OS 9.1.11-h2",
				"PAN-OS 9.1.11-h1",
				"PAN-OS 9.1.11",
				"PAN-OS 9.1.10",
				"PAN-OS 9.1.9",
				"PAN-OS 9.1.8",
				"PAN-OS 9.1.7",
				"PAN-OS 9.1.6",
				"PAN-OS 9.1.5",
				"PAN-OS 9.1.4",
				"PAN-OS 9.1.3-h1",
				"PAN-OS 9.1.3",
				"PAN-OS 9.1.2-h1",
				"PAN-OS 9.1.2",
				"PAN-OS 9.1.1",
				"PAN-OS 9.1.0-h3",
				"PAN-OS 9.1.0-h2",
				"PAN-OS 9.1.0-h1",
				"PAN-OS 9.1.0",
				"PAN-OS 9.1",
				"Cloud NGFW"
			]
		}
	}
}
