{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2023-38802",
		"assignerOrgId": "d6c1279f-00f6-4ef7-9217-f89ffe703ec0",
		"assignerShortName": "palo_alto",
		"state": "PUBLISHED",
		"datePublished": "2023-09-13T16:00:00.000Z",
		"dateUpdated": "2024-01-18T00:00:00.000000Z",
		"dateReserved": "2023-09-13T16:00:00.000Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8254265b-2729-46b6-b9e3-3dfca2d5bfca",
				"shortName": "mitre",
				"dateUpdated": "2023-11-15T05:07:02.171314"
			},
			"title": " PAN-OS: Denial-of-Service (DoS) Vulnerability in BGP Software",
			"descriptions": [
				{
					"lang": "en",
					"value": "BGP software such as FRRouting FRR included as part of the PAN-OS, Prisma SD-WAN ION, and Prisma Access routing features enable a remote attacker to incorrectly reset network sessions though an invalid BGP update. This issue is applicable only to devices and appliances with BGP routing features enabled.\n\nThis issue requires the remote attacker to control at least one established BGP session that is propagated to the router to exploit it. The denial-of-service (DoS) impact on the network is dependent on the network's architecture and fault tolerant design.\n\nPrisma Access ‘Security Processing Node Endpoint Remote Network (SP-RN/Branches)' and 'Service Connections (SCs/CANs)' nodes do not peer with the Internet and do not receive Internet routes directly unless explicitly configured by the customer. Prisma Access Nodes are commonly protected by unaffected customer-premise equipment (CPE router devices). Hence the impact of this issue on Prisma Access is limited.\n\nFurther details about this issue can be found at: https://blog.benjojo.co.uk/post/bgp-path-attributes-grave-error-handling\n",
					"supportingMedia": [
						{
							"base64": "false",
							"type": "text/html",
							"value": "<pre>BGP software such as FRRouting FRR included as part of the PAN-OS, Prisma SD-WAN ION, and Prisma Access routing features enable a remote attacker to incorrectly reset network sessions though an invalid BGP update. This issue is applicable only to devices and appliances with BGP routing features enabled.\n\nThis issue requires the remote attacker to control at least one established BGP session that is propagated to the router to exploit it. The denial-of-service (DoS) impact on the network is dependent on the network's architecture and fault tolerant design.\n\nPrisma Access ‘Security Processing Node Endpoint Remote Network (SP-RN/Branches)' and 'Service Connections (SCs/CANs)' nodes do not peer with the Internet and do not receive Internet routes directly unless explicitly configured by the customer. Prisma Access Nodes are commonly protected by unaffected customer-premise equipment (CPE router devices). Hence the impact of this issue on Prisma Access is limited.\n\nFurther details about this issue can be found at: https://blog.benjojo.co.uk/post/bgp-path-attributes-grave-error-handling\n</pre>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Palo Alto Networks",
					"product": "Cloud NGFW",
					"versions": [
						{
							"status": "unaffected",
							"version": "All"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "PAN-OS",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "11.0",
							"lessThan": "11.0.3",
							"changes": [
								{
									"at": "11.0.3",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.2",
							"lessThan": "10.2.6",
							"changes": [
								{
									"at": "10.2.6",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "10.1",
							"lessThan": "10.1.11",
							"changes": [
								{
									"at": "10.1.11",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "9.1",
							"lessThan": "9.1.16-h3",
							"changes": [
								{
									"at": "9.1.16-h3",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "8.1",
							"lessThan": "8.1.26",
							"changes": [
								{
									"at": "8.1.26",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "9.0",
							"lessThan": "9.0.17-h4",
							"changes": [
								{
									"at": "9.0.17-h4",
									"status": "unaffected"
								}
							]
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Prisma Access",
					"versions": [
						{
							"status": "affected",
							"version": "Customers whose most recent software upgrade was before 09/30"
						},
						{
							"status": "unaffected",
							"version": "Customers who have received a software upgrade or are using new software on or after 09/30"
						}
					]
				},
				{
					"vendor": "Palo Alto Networks",
					"product": "Prisma SD-WAN ION",
					"versions": [
						{
							"status": "unaffected",
							"version": "5.6 All"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.1",
							"lessThan": "6.1.5",
							"changes": [
								{
									"at": "6.1.5",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "6.2",
							"lessThan": "6.2.3",
							"changes": [
								{
									"at": "6.2.3",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-754 Improper Check for Unusual or Exceptional Conditions",
							"cweId": "CWE-754"
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:N/AU:Y/R:A/V:C/RE:L/U:Amber",
						"baseScore": 8.2,
						"baseSeverity": "HIGH",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"vulnConfidentialityImpact": "NONE",
						"vulnIntegrityImpact": "NONE",
						"vulnAvailabilityImpact": "HIGH",
						"subConfidentialityImpact": "NONE",
						"subIntegrityImpact": "NONE",
						"subAvailabilityImpact": "NONE",
						"Safety": "NOT_DEFINED",
						"Automatable": "YES",
						"Recovery": "AUTOMATIC",
						"valueDensity": "CONCENTRATED",
						"vulnerabilityResponseEffort": "LOW",
						"providerUrgency": "AMBER"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "You can prevent exploitation of this issue by inserting an unaffected BGP router—configured to drop the invalid BGP update instead of propagating it—between the attacker-originated BGP update and PAN-OS, Prisma SD-WAN ION, and Prisma Access devices. This stops the invalid BGP update from reaching the affected router.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "You can prevent exploitation of this issue by inserting an unaffected BGP router—configured to drop the invalid BGP update instead of propagating it—between the attacker-originated BGP update and PAN-OS, Prisma SD-WAN ION, and Prisma Access devices. This stops the invalid BGP update from reaching the affected router."
					}
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "This issue is fixed in PAN-OS 8.1.26, PAN-OS 9.0.17-h4, PAN-OS 9.1.16-h3, PAN-OS 10.1.11, PAN-OS 10.2.6, PAN-OS 11.0.3, and all later PAN-OS versions.\n\nThis issue is fixed in Prisma SD-WAN ION 6.1.5, Prisma SD-WAN ION 6.2.3, and all later Prisma SD-WAN ION versions. This issue does not impact Prisma SD-WAN ION 5.6 versions.\n\nFor Prisma Access customers, the upgrade to fix this issue will be available on 09/30. Customers should work with their Prisma Access contacts and support to secure a maintenance window for the on-demand software upgrade.\n\nPlease note that full Prisma Access data plane upgrades scheduled on and after 09/30 will have this fix incorporated by default. No additional action is necessary for these customers to remediate this issue.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is fixed in PAN-OS 8.1.26, PAN-OS 9.0.17-h4, PAN-OS 9.1.16-h3, PAN-OS 10.1.11, PAN-OS 10.2.6, PAN-OS 11.0.3, and all later PAN-OS versions.\n\nThis issue is fixed in Prisma SD-WAN ION 6.1.5, Prisma SD-WAN ION 6.2.3, and all later Prisma SD-WAN ION versions. This issue does not impact Prisma SD-WAN ION 5.6 versions.\n\nFor Prisma Access customers, the upgrade to fix this issue will be available on 09/30. Customers should work with their Prisma Access contacts and support to secure a maintenance window for the on-demand software upgrade.\n\nPlease note that full Prisma Access data plane upgrades scheduled on and after 09/30 will have this fix incorporated by default. No additional action is necessary for these customers to remediate this issue."
					}
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue targeting our customers. However, knowledge of invalid BGP attributes that trigger this issue is publicly available.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "Palo Alto Networks is not aware of any malicious exploitation of this issue targeting our customers. However, knowledge of invalid BGP attributes that trigger this issue is publicly available."
					}
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "This issue is applicable only to devices and appliances that are configured with BGP routing features enabled. You can verify whether BGP is enabled for a router by selecting it from 'Network > Virtual Routers’ or 'Network > Logical Routers’ in the web interface of PAN-OS firewalls.\n\nTo exploit this issue, the remote attacker must control at least one established BGP session that is propagated to the router.",
					"supportingMedia": {
						"base64": false,
						"type": "text/html",
						"value": "This issue is applicable only to devices and appliances that are configured with BGP routing features enabled. You can verify whether BGP is enabled for a router by selecting it from 'Network > Virtual Routers’ or 'Network > Logical Routers’ in the web interface of PAN-OS firewalls.\n\nTo exploit this issue, the remote attacker must control at least one established BGP session that is propagated to the router."
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://security.paloaltonetworks.com/CVE-2023-38802"
				},
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://blog.benjojo.co.uk/post/bgp-path-attributes-grave-error-handling"
				}
			],
			"timeline": [
				{
					"time": "2023-12-13T17:00:00.000Z",
					"lang": "eng",
					"value": "Updated the ETA for the fix in Prisma SD-WAN ION 6.2"
				},
				{
					"time": "2023-12-09T00:00:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in PAN-OS 8.1.26 and PAN-OS 9.0.17-h4"
				},
				{
					"time": "2023-11-08T17:00:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in PAN-OS 11.0.3 and added CVSS 4.0 scoring"
				},
				{
					"time": "2023-11-08T17:00:00.000Z",
					"lang": "eng",
					"value": "A fix for this issue is being developed for PAN-OS 8.1 and PAN-OS 9.0"
				},
				{
					"time": "2023-11-02T21:05:00.000Z",
					"lang": "eng",
					"value": "Updated the ETA for the fix in PAN-OS 11.0.3"
				},
				{
					"time": "2023-10-24T02:20:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in Prisma SD-WAN ION 6.1.5"
				},
				{
					"time": "2023-10-16T16:15:00.000Z",
					"lang": "eng",
					"value": "Updated the ETA for the fix in Prisma SD-WAN ION 6.1"
				},
				{
					"time": "2023-10-11T16:00:00.000Z",
					"lang": "eng",
					"value": "Updated the ETA for the fix in PAN-OS 11.0.3"
				},
				{
					"time": "2023-10-04T02:05:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in PAN-OS 9.1.16-h3"
				},
				{
					"time": "2023-09-28T04:45:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in PAN-OS 10.1.11 and 10.2.6"
				},
				{
					"time": "2023-09-22T00:02:00.000Z",
					"lang": "eng",
					"value": "Updated guidance for Prisma Access customers"
				},
				{
					"time": "2023-09-16T00:34:00.000Z",
					"lang": "eng",
					"value": "Prisma SD-WAN ION is confirmed to be impacted"
				},
				{
					"time": "2023-09-15T01:00:00.000Z",
					"lang": "eng",
					"value": "The impact of this issue is under investigation for Prisma Access"
				},
				{
					"time": "2023-09-13T16:00:00.000Z",
					"lang": "eng",
					"value": "Initial Publication"
				},
				{
					"time": "2024-01-18T18:00:00.000Z",
					"lang": "eng",
					"value": "Updated availability of the fix in Prisma SD-WAN ION 6.2.3"
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "Palo Alto Networks thanks Ben Cartwright-Cox for discovering this issue in BGP implementations."
				}
			],
			"source": {
				"defect": [
					"PAN-227523"
				],
				"discovery": "EXTERNAL"
			},
			"datePublic": "2023-09-13T16:00:00.000Z",
			"x_generator": {
				"engine": "vulnogram 0.1.0-rc1"
			},
			"x_affectedList": [
				"Prisma SD-WAN ION 6.2",
				"Prisma SD-WAN ION 6.1",
				"Prisma Access",
				"PAN-OS 11.0.2-h1",
				"PAN-OS 11.0.2",
				"PAN-OS 11.0.1-h2",
				"PAN-OS 11.0.1-h1",
				"PAN-OS 11.0.1",
				"PAN-OS 11.0.0",
				"PAN-OS 11.0",
				"PAN-OS 10.2.5",
				"PAN-OS 10.2.4-h4",
				"PAN-OS 10.2.4-h3",
				"PAN-OS 10.2.4-h2",
				"PAN-OS 10.2.4-h1",
				"PAN-OS 10.2.4",
				"PAN-OS 10.2.3-h4",
				"PAN-OS 10.2.3-h3",
				"PAN-OS 10.2.3-h2",
				"PAN-OS 10.2.3-h1",
				"PAN-OS 10.2.3",
				"PAN-OS 10.2.2-h2",
				"PAN-OS 10.2.2-h1",
				"PAN-OS 10.2.2",
				"PAN-OS 10.2.1",
				"PAN-OS 10.2.0",
				"PAN-OS 10.2",
				"PAN-OS 10.1.10-h2",
				"PAN-OS 10.1.10-h1",
				"PAN-OS 10.1.10",
				"PAN-OS 10.1.9-h3",
				"PAN-OS 10.1.9-h2",
				"PAN-OS 10.1.9-h1",
				"PAN-OS 10.1.9",
				"PAN-OS 10.1.8-h2",
				"PAN-OS 10.1.8-h1",
				"PAN-OS 10.1.8",
				"PAN-OS 10.1.7",
				"PAN-OS 10.1.6-h6",
				"PAN-OS 10.1.6-h5",
				"PAN-OS 10.1.6-h4",
				"PAN-OS 10.1.6-h3",
				"PAN-OS 10.1.6-h2",
				"PAN-OS 10.1.6-h1",
				"PAN-OS 10.1.6",
				"PAN-OS 10.1.5-h2",
				"PAN-OS 10.1.5-h1",
				"PAN-OS 10.1.5",
				"PAN-OS 10.1.4-h4",
				"PAN-OS 10.1.4-h3",
				"PAN-OS 10.1.4-h2",
				"PAN-OS 10.1.4-h1",
				"PAN-OS 10.1.4",
				"PAN-OS 10.1.3",
				"PAN-OS 10.1.2",
				"PAN-OS 10.1.1",
				"PAN-OS 10.1.0",
				"PAN-OS 10.1",
				"PAN-OS 9.1.16-h2",
				"PAN-OS 9.1.16-h1",
				"PAN-OS 9.1.16",
				"PAN-OS 9.1.15-h1",
				"PAN-OS 9.1.15",
				"PAN-OS 9.1.14-h4",
				"PAN-OS 9.1.14-h3",
				"PAN-OS 9.1.14-h2",
				"PAN-OS 9.1.14-h1",
				"PAN-OS 9.1.14",
				"PAN-OS 9.1.13-h3",
				"PAN-OS 9.1.13-h2",
				"PAN-OS 9.1.13-h1",
				"PAN-OS 9.1.13",
				"PAN-OS 9.1.12-h3",
				"PAN-OS 9.1.12-h2",
				"PAN-OS 9.1.12-h1",
				"PAN-OS 9.1.12",
				"PAN-OS 9.1.11-h3",
				"PAN-OS 9.1.11-h2",
				"PAN-OS 9.1.11-h1",
				"PAN-OS 9.1.11",
				"PAN-OS 9.1.10",
				"PAN-OS 9.1.9",
				"PAN-OS 9.1.8",
				"PAN-OS 9.1.7",
				"PAN-OS 9.1.6",
				"PAN-OS 9.1.5",
				"PAN-OS 9.1.4",
				"PAN-OS 9.1.3-h1",
				"PAN-OS 9.1.3",
				"PAN-OS 9.1.2-h1",
				"PAN-OS 9.1.2",
				"PAN-OS 9.1.1",
				"PAN-OS 9.1.0-h3",
				"PAN-OS 9.1.0-h2",
				"PAN-OS 9.1.0-h1",
				"PAN-OS 9.1.0",
				"PAN-OS 9.1",
				"PAN-OS 9.0",
				"PAN-OS 8.1"
			]
		}
	}
}
